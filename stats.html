<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… ÙˆØ§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø­ÙŠØ© - Ø¯Ù…Ø¬ Ø°ÙƒÙŠ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap">
  <style>
    /* Ù†ÙØ³ Ø§Ù„ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© ØªÙ…Ø§Ù…Ø§Ù‹ Ù„Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ø§Ù„Ø´ÙƒÙ„ Ø§Ù„Ø¬Ù…ÙŠÙ„ */
    :root {
      --primary-color: #0072ff;
      --secondary-color: #00c6ff;
      --bg-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
      --glass-bg: rgba(255, 255, 255, 0.98);
      --glass-shadow: 0 20px 60px 0 rgba(31, 38, 135, 0.35);
      --text-color: #2d3436;
      --danger-color: #ff4757;
      --success-color: #2ecc71;
      --warning-color: #ffa502;
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'Cairo', sans-serif; padding: 20px; min-height: 100vh;
      background: var(--bg-gradient); background-size: 400% 400%;
      animation: gradientBG 20s ease infinite; color: var(--text-color);
      position: relative; overflow-x: hidden;
    }
    @keyframes gradientBG {
      0% { background-position: 0% 50%; } 50% { background-position: 100% 100%; } 100% { background-position: 0% 50%; }
    }
    .circles { position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; z-index: 0; pointer-events: none; }
    .circles li { position: absolute; display: block; list-style: none; width: 20px; height: 20px; background: rgba(255, 255, 255, 0.15); animation: float 25s linear infinite; bottom: -150px; border-radius: 50%; backdrop-filter: blur(5px); }
    .circles li:nth-child(1){ left: 25%; width: 100px; height: 100px; animation-duration: 20s; }
    .circles li:nth-child(2){ left: 10%; width: 30px; height: 30px; animation-duration: 15s; }
    .circles li:nth-child(3){ left: 70%; width: 30px; height: 30px; animation-duration: 18s; }
    .circles li:nth-child(4){ left: 40%; width: 80px; height: 80px; animation-duration: 22s; }
    .circles li:nth-child(5){ left: 65%; width: 25px; height: 25px; animation-duration: 17s; }
    @keyframes float { 0%{ transform: translateY(0) rotate(0deg); opacity: 0.8; } 50%{ opacity: 1; } 100%{ transform: translateY(-1200px) rotate(720deg); opacity: 0; } }

    #loginScreen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(135deg, rgba(102, 126, 234, 0.9), rgba(118, 75, 162, 0.9)); backdrop-filter: blur(20px); z-index: 9999; display: flex; justify-content: center; align-items: center; }
    .login-box { background: white; padding: 50px 40px; border-radius: 30px; text-align: center; width: 90%; max-width: 450px; box-shadow: 0 30px 80px rgba(0,0,0,0.4); position: relative; overflow: hidden; }
    .login-box::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 5px; background: linear-gradient(90deg, var(--primary-color), var(--secondary-color), var(--primary-color)); background-size: 200% 100%; animation: shimmer 3s linear infinite; }
    @keyframes shimmer { 0% { background-position: 200% 0; } 100% { background-position: -200% 0; } }
    .login-box h2 { margin-bottom: 15px; color: var(--primary-color); }
    .login-box input { width: 100%; padding: 18px; margin: 25px 0; border: 2px solid #eee; border-radius: 15px; font-family: 'Cairo'; text-align: center; background: #f8f9fa; }
    .login-btn { background: linear-gradient(135deg, var(--primary-color), var(--secondary-color)); color: white; border: none; padding: 15px 50px; border-radius: 50px; font-family: 'Cairo'; cursor: pointer; font-weight: 600; box-shadow: 0 10px 25px rgba(0, 114, 255, 0.3); }

    .container { max-width: 1400px; margin: 0 auto; background: var(--glass-bg); backdrop-filter: blur(15px); border-radius: 30px; box-shadow: var(--glass-shadow); padding: 40px; display: none; position: relative; z-index: 1; }
    .container.visible { display: block; animation: fadeIn 0.5s ease; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

    .header-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; flex-wrap: wrap; gap: 15px; border-bottom: 3px solid transparent; border-image: linear-gradient(90deg, var(--primary-color), var(--secondary-color)) 1; padding-bottom: 10px; }
    h2 { background: linear-gradient(135deg, var(--primary-color), var(--secondary-color)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; font-weight: 700; }
    .controls { display: flex; gap: 10px; flex-wrap: wrap; }
    .btn { padding: 10px 20px; border-radius: 50px; border: none; color: white; cursor: pointer; font-family: 'Cairo'; font-weight: bold; box-shadow: 0 4px 15px rgba(0,0,0,0.1); transition: transform 0.2s; }
    .btn:hover { transform: translateY(-2px); }
    .btn-print { background: #0984e3; }
    .btn-excel { background: #00b894; }
    .btn-merge { background: #e17055; } /* Ù„ÙˆÙ† Ø²Ø± Ø§Ù„Ø¯Ù…Ø¬ */
    .btn-reset { background: #d63031; }
    .btn-back { background: #636e72; }

    .table-wrapper { overflow-x: auto; background: white; border-radius: 20px; padding: 10px; box-shadow: 0 5px 15px rgba(0,0,0,0.05); }
    table { width: 100%; border-collapse: separate; border-spacing: 0; min-width: 800px; }
    th { background: #f1f2f6; color: var(--primary-color); padding: 15px; border-bottom: 2px solid var(--primary-color); white-space: nowrap; }
    td { padding: 15px; border-bottom: 1px solid #eee; text-align: center; }
    tr:hover { background: #f8f9fa; }

    /* ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨ */
    .rep-list-container { display: flex; flex-direction: column; gap: 5px; max-width: 250px; margin: 0 auto; }
    .rep-tag { background: #f1f2f6; padding: 8px 12px; border-radius: 10px; display: flex; justify-content: space-between; align-items: center; cursor: pointer; transition: 0.3s; border-right: 3px solid var(--primary-color); }
    .rep-tag:hover { background: #e1e2e6; transform: translateX(-3px); }
    .statok { background: var(--success-color); color: white; padding: 2px 10px; border-radius: 15px; font-size: 0.9em; font-weight: bold; }

    /* Ù†ØµØ§Ø¨Ø© */
    .nassaba-cell { color: var(--danger-color); font-weight: bold; cursor: pointer; text-decoration: underline; }
    .zero-nassaba { color: #ccc; }

    /* Modals */
    .modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 10000; display: none; justify-content: center; align-items: center; backdrop-filter: blur(5px); }
    .modal-content { background: white; padding: 40px; border-radius: 20px; width: 90%; max-width: 500px; text-align: center; position: relative; max-height: 80vh; overflow-y: auto; }
    .close-modal { position: absolute; top: 15px; left: 15px; font-size: 24px; cursor: pointer; color: #aaa; }
    
    /* Merge Styles */
    .merge-input-group { text-align: right; margin-bottom: 15px; }
    .merge-input-group label { display: block; margin-bottom: 5px; font-weight: bold; color: #333; }
    .merge-input-group input { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px; font-family: 'Cairo'; }
    .merge-list { list-style: none; padding: 0; margin-top: 20px; text-align: right; }
    .merge-list li { background: #fff5f5; border: 1px solid #ffeaa7; padding: 10px; margin-bottom: 5px; border-radius: 8px; display: flex; justify-content: space-between; align-items: center; }
    .delete-merge { color: red; font-weight: bold; cursor: pointer; font-size: 1.2em; padding: 0 10px; }

    .loader { border: 4px solid #f3f3f3; border-top: 4px solid var(--primary-color); border-radius: 50%; width: 50px; height: 50px; animation: spin 1s linear infinite; margin: 50px auto; }
    @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

    @media print {
        .circles, #loginScreen, .controls, .modal { display: none !important; }
        .container { box-shadow: none; margin: 0; width: 100%; max-width: 100%; padding: 0; }
        table { border: 1px solid #000; }
        th, td { border: 1px solid #000; color: #000; }
    }
  </style>
</head>
<body>

  <div id="loginScreen">
    <div class="login-box">
      <h2>Ù…Ø­Ù…ÙŠØ© Ø¨ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ±</h2>
      <p>Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù…Ø²</p>
      <input type="password" id="passwordInput" placeholder="******">
      <button class="login-btn" onclick="checkPassword()">Ø¯Ø®ÙˆÙ„</button>
      <p id="errorMsg" style="color:red; display:none; margin-top:10px;">Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ÙƒÙˆØ¯</p>
    </div>
  </div>

  <div id="repModal" class="modal">
      <div class="modal-content">
          <div class="close-modal" onclick="closeModal('repModal')">&times;</div>
          <h3 style="color:var(--primary-color)" id="modalRepName"></h3>
          <p>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„Ø§Øª Ø§Ù„Ù…Ø¹ØªÙ…Ø¯Ø©</p>
          <div style="font-size:5rem; font-weight:800; color:var(--primary-color);" id="modalRepCount">0</div>
      </div>
  </div>

  <div id="nassabaModal" class="modal">
    <div class="modal-content">
        <div class="close-modal" onclick="closeModal('nassabaModal')">&times;</div>
        <h3 style="color:var(--danger-color)">âš ï¸ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªÙƒØ±Ø§Ø±</h3>
        <h4 id="nassabaPlaceName" style="color:#555; margin-bottom:15px;"></h4>
        <ul id="nassabaListContainer" style="list-style:none; padding:0; text-align:right;"></ul>
    </div>
  </div>

  <div id="mergeModal" class="modal">
    <div class="modal-content">
        <div class="close-modal" onclick="closeModal('mergeModal')">&times;</div>
        <h3 style="color:#e17055; margin-bottom:15px;">ğŸ”— Ø¯Ù…Ø¬ Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨ÙŠÙ†</h3>
        <p style="font-size:0.9rem; color:#666; margin-bottom:20px;">
            Ø³ÙŠØªÙ… Ø¬Ù…Ø¹ Ø£Ø±Ù‚Ø§Ù… (Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ù‚Ø¯ÙŠÙ…) ÙˆØ¥Ø¶Ø§ÙØªÙ‡Ø§ Ø¥Ù„Ù‰ (Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯) ÙˆØ³ÙŠØ¸Ù‡Ø± Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯ ÙÙ‚Ø·.
        </p>
        
        <div class="merge-input-group">
            <label>Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø°ÙŠ ØªØ±ÙŠØ¯ Ø¥Ù„ØºØ§Ø¡Ù‡ (Ø§Ù„Ù‚Ø¯ÙŠÙ…):</label>
            <input type="text" id="mergeFrom" placeholder="Ø§Ù†Ø³Ø® Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ù‚Ø¯ÙŠÙ… Ù‡Ù†Ø§">
        </div>
        <div class="merge-input-group">
            <label>Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø°ÙŠ ØªØ±ÙŠØ¯ Ø§Ù„Ø¬Ù…Ø¹ ÙÙŠÙ‡ (Ø§Ù„Ø¬Ø¯ÙŠØ¯):</label>
            <input type="text" id="mergeTo" placeholder="Ø§Ù†Ø³Ø® Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ù…Ø¹ØªÙ…Ø¯ Ù‡Ù†Ø§">
        </div>
        <button class="btn btn-merge" style="width:100%" onclick="addMergeRule()">ØªÙ†ÙÙŠØ° Ø§Ù„Ø¯Ù…Ø¬ ÙˆØ­ÙØ¸</button>

        <h4 style="margin-top:25px; text-align:right; border-bottom:1px solid #eee; padding-bottom:5px;">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¯Ù…Ø¬ Ø§Ù„Ù†Ø´Ø·Ø©:</h4>
        <ul id="mergeListDisplay" class="merge-list"></ul>
    </div>
  </div>

  <ul class="circles"><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul>

  <div class="container">
    <div class="header-row">
      <h2>Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª (Ù…Ø¬Ù…Ø¹Ø©) ğŸ”´</h2>
      <div class="controls">
        <button class="btn btn-print" onclick="window.print()">Ø·Ø¨Ø§Ø¹Ø©</button>
        <button class="btn btn-excel" onclick="exportToExcel()">Excel</button>
        <button class="btn btn-merge" onclick="document.getElementById('mergeModal').style.display='flex'">Ø¯Ù…Ø¬ Ø§Ù„Ø§Ø³Ù…Ø§Ø¡</button>
        <button class="btn btn-reset" onclick="resetData()">ØªØµÙÙŠØ±</button>
        <button class="btn btn-back" onclick="location='DelegateApp_Pro.html'">Ø¹ÙˆØ¯Ø©</button>
      </div>
    </div>

    <div class="table-wrapper">
      <table id="statTable">
        <thead>
          <tr>
            <th>Ù…</th>
            <th>Ø§Ù„Ù…ÙƒØ§Ù†</th>
            <th>Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„ÙƒÙ„ÙŠ</th>
            <th style="color:var(--danger-color);">Ù†ØµØ§Ø¨Ø©</th>
            <th>ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù†Ø§Ø¯ÙŠØ¨ (Ø¨Ø¹Ø¯ Ø§Ù„Ø¯Ù…Ø¬)</th>
            <th>Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©</th>
            <th>Ø§Ù„Ù†Ù‡Ø§ÙŠØ©</th>
            <th>Ø§Ù„Ù…Ø¯Ø©</th>
          </tr>
        </thead>
        <tbody id="tbody">
          <tr><td colspan="8"><div class="loader"></div></td></tr>
        </tbody>
      </table>
    </div>
  </div>
  
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
    import { getDatabase, ref, onValue, remove } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js";

    const firebaseConfig = {
      apiKey: "AIzaSyAxnIxtFeAOjYjCIrU5cwYVteuQ18K8Kjc",
      authDomain: "idmanazla.firebaseapp.com",
      databaseURL: "https://idmanazla-default-rtdb.europe-west1.firebasedatabase.app",
      projectId: "idmanazla",
      storageBucket: "idmanazla.firebasestorage.app",
      messagingSenderId: "408446131276",
      appId: "1:408446131276:web:976ae54181b5398de5a8e9",
      measurementId: "G-9YSW9HNYTG"
    };
    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    const places = [
      "Ø§Ù„Ù…Ù†Ø²Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© 1 - ÙƒØ±ÙŠÙ… Ø§Ù„Ù…Ø±ÙˆØ±", "Ø§Ù„Ù…Ù†Ø²Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© 2 - Ø´Ø±ÙŠÙ Ø§Ù„ØªØ£Ù…ÙŠÙ† Ø§Ù„ØµØ­ÙŠ",
      "Ø¨Ø­Ø± Ø§Ù„Ø¨Ù„Ø¯ Ø´Ø§Ø±Ø¹ Ø§Ù„ÙƒØ§Ø¨ØªÙ† - Ø´Ø±ÙŠÙ Ø§Ù„Ø¹Ø²Ø§Ø²ÙŠ", "Ù…Ø¯Ø±Ø³Ø© Ø¹Ø¨Ø¯ Ø§Ù„Ø¹Ø§Ù„ Ø´Ù„Ø¨ÙŠØ§ÙŠØ© - Ø§Ø´Ø±Ù Ø§Ù„Ø£Ø¨Ø§ØµÙŠØ±ÙŠ",
      "Ù…ØµÙ†Ø¹ Ø§Ù„Ø¨ØµÙ„ - ÙØ¤Ø§Ø¯ Ø­Ø§Ù„", "Ø§Ù„ÙƒÙØ± 1 - Ø¹Ù„ÙŠ Ø´Ø·Ø§", "Ø§Ù„ÙƒÙØ± 2 ØªØ­Øª Ø§Ù„Ø³ÙƒØ© - Ø¹Ø§Ø¯Ù„ Ø¬Ù„Ø§Ù„",
      "Ø³ÙˆÙ‚ Ø§Ù„Ø¬Ù…Ù„Ø© - Ø§Ù„Ø³Ø¹ÙŠØ¯ Ø´Ø·Ø§- Ø¹Ù„Ù‰ Ø§Ù„Ø¨ÙŠØ§Ø¹", "Ø§Ù„ÙØ¯Ø§Ø¡ 1 - Ø¹Ù…Ø± Ø§Ù„ÙƒÙŠØ§Ù„", "Ø§Ù„ÙØ¯Ø§Ø¡ 2 - Ø­Ù…Ø§Ø¯Ù‡ Ø§Ù„ÙƒÙŠØ§Ù„",
      "Ø§Ù„Ø­Ù…Ø²Ø§ÙˆÙŠ - Ø­Ù…Ø§Ø¯Ù‡ Ø§Ù„Ø³Ø±ÙŠ", "Ø§Ù„Ø¬Ø±Ù† 1 - Ø¨ÙˆØ¬ÙŠ Ø§Ù„Ø¨Ø±Ø¹ÙŠ", "Ø§Ù„Ø¬Ø±Ù† 2 - Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ… ÙÙ‡ÙŠØ¯",
      "Ø§Ù„Ø¨Ø± Ø§Ù„Ø«Ø§Ù†ÙŠ Ø­ÙŠ Ø§Ù„Ø³Ù„Ø§Ù… - ÙŠØ­ÙŠÙ‰ Ø­Ø¨Ù‚", "Ø­ÙŠ Ø§Ù„Ø£Ø¹Ø¬Ø§Ù… - Ø­Ù…Ø§Ø¯Ù‡ Ø§Ø¨Ùˆ Ø±Ø´Ø§Ø¯",
      "Ø§Ù„Ø¹Ø²Ø¨Ø© Ù…Ù†Ø´ÙŠØ© Ù†Ø§ØµØ± -Ø­Ø³Ø§Ù† Ø¹Ø·ÙŠØ©", "Ø§Ù„Ø·ÙˆÙŠÙ„ - Ø£Ø­Ù…Ø¯ Ø¹Ø¨Ø¯ Ø§Ù„Ø¹Ø¸ÙŠÙ…",
      "Ø§Ù„Ø¨Ø± Ø§Ù„Ø«Ø§Ù†ÙŠ 2 Ø§Ù„Ù‡Ø§ÙˆÙŠØ³ - Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ… Ø¹Ø¨Ø¯ Ø§Ù„Ù…Ø¬ÙŠØ¯", "Ø§Ù„ÙÙ‚Ø§Ø¹ÙŠ - Ù…Ø­Ù…Ø¯ Ø­Ø¨ÙŠØ¨",
      "Ø¨Ø­Ø± Ø§Ù„Ø¨Ù„Ø¯ 2 - Ø§Ù„Ø³ÙŠØ¯ Ø­Ø±Ø§Ø²", "Ø­ÙŠ Ø§Ù„Ø¬Ø¨Ø§Ù†Ø© - Ø³Ø¹Ø¯ Ø§Ù„Ø´Ù„ÙˆØ¯ÙŠ",
      "Ø§Ù„ÙƒÙØ± 3 Ø¨Ø¬ÙˆØ§Ø± Ù…Ù„Ø¹Ø¨ Ø¨Ø±Ø´Ù„ÙˆÙ†Ø© - Ù…Ø­Ù…Ø¯ Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©", "Ø£Ø¨Ùˆ Ø±Ø´Ø§Ø¯ Ù…Ù‚Ù‡Ù‰ Ø£Ø¨Ùˆ Ø³Ù„ÙŠÙ…Ø§Ù† - Ù…Ø­Ù…Ø¯ Ø±Ø´Ø§Ø¯",
      "Ø­ÙŠ Ø§Ù„Ø²Ù‡Ø±Ø§Ø¡ - Ø±Ø´Ø§Ø¯ Ø¹Ø¨Ø¯ Ø§Ù„ÙˆÙ‡Ø§Ø¨", "Ø¨Ø­Ø± Ø§Ù„Ø¨Ù„Ø¯ 3 - Ù…Ù†ØµÙˆØ± Ø§Ù„Ø¨Ø¯Ø±ÙŠ",
      "Ø­ÙŠ Ø§Ù„Ø³Ù„Ù…ÙˆÙ†ÙŠ - Ø­Ø³Ù† Ø§Ù„Ù…Ù†Ø§Ø®Ù„Ù‰", "Ø­Ù‰ Ù…Ø²Ù„ÙØ§Ù† Ø§Ù„Ø¹Ù„Ù…ÙŠ -Ø£Ø¨ÙˆØ¹Ù„Ø§Ø¡",
      "Ø­ÙŠ Ø§Ù„Ø¨ØµÙ„Ù‡ Ø­Ù…ÙˆØ¯-Ø¹Ø¨Ø¯ Ø§Ù„Ø­Ù…ÙŠØ¯", "Ø­Ù‰ Ø§Ù„Ø¬Ø±Ù† 3 -Ù‚Ù‡ÙˆØ© Ø§Ù„Ù†Ø¬Ø¯ÙŠ Ù…Ø­Ù…Ø¯ Ø§Ù„Ù†Ø¬Ø¯ÙŠ"
    ];

    // Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø¯Ù…Ø¬
    window.mergeMap = JSON.parse(localStorage.getItem('repMergeRules')) || {};

    window.startListening = function() {
      const dbRef = ref(db);
      
      onValue(dbRef, (snapshot) => {
        const data = snapshot.val() || {};
        const users = data.users || {};
        const duplicates = data.duplicates || {};

        let perPlace = {};
        
        // ** Ù‡Ù†Ø§ ÙŠØ­Ø¯Ø« Ø§Ù„Ø³Ø­Ø± ÙˆØ§Ù„Ø¯Ù…Ø¬ **
        for (let id in users) {
          let u = users[id];
          const key = u.place;
          if (!key) continue;

          // 1. ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø§Ø³Ù… Ù…Ù† Ø§Ù„Ù…Ø³Ø§ÙØ§Øª
          let rawName = u.repName ? u.repName.trim() : "ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ";

          // 2. Ø§Ù„ØªØ­Ù‚Ù‚: Ù‡Ù„ Ù‡Ø°Ø§ Ø§Ù„Ø§Ø³Ù… Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¯Ù…Ø¬ØŸ
          // Ø¥Ø°Ø§ Ù†Ø¹Ù…ØŒ Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯. Ø¥Ø°Ø§ Ù„Ø§ØŒ Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø§Ø³Ù… ÙƒÙ…Ø§ Ù‡Ùˆ.
          let finalRepName = window.mergeMap[rawName] ? window.mergeMap[rawName] : rawName;

          if (!perPlace[key]) {
            perPlace[key] = {count:0, nassabaList:[], reps:{}, times:[]};
          }
          
          perPlace[key].count++;
          
          // 3. Ø§Ù„ØªØ¬Ù…ÙŠØ¹ ÙŠØªÙ… Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ (Ø§Ù„Ù…Ø¯Ù…Ø¬)
          // Ù‡Ø°Ø§ ÙŠØ¹Ù†ÙŠ Ø£Ù† Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¯ Ø³ØªØªØ±Ø§ÙƒÙ… ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ ØªØ­Øª Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯
          if (!perPlace[key].reps[finalRepName]) {
             perPlace[key].reps[finalRepName] = [];
          }
          perPlace[key].reps[finalRepName].push(u.time);
          perPlace[key].times.push(u.time);
        }

        // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ù†ØµØ§Ø¨Ø©
        for (let pushId in duplicates) {
            let d = duplicates[pushId];
            const key = d.attemptPlace;
            if (!perPlace[key]) {
                  perPlace[key] = {count:0, nassabaList:[], reps:{}, times:[]};
            }
            perPlace[key].nassabaList.push({
                id: d.duplicatedID, by: d.attemptByRep, time: d.timestamp
            });
        }

        window.allStats = perPlace;
        renderTable(perPlace);
      }, (error) => {
        document.getElementById('tbody').innerHTML = `<tr><td colspan="8" style="color:red">Ø­Ø¯Ø« Ø®Ø·Ø£: ${error.message}</td></tr>`;
      });
    };

    function renderTable(perPlace) {
        // Ù…ÙØ§ØªÙŠØ­ Ø§Ù„Ø£Ù…Ø§ÙƒÙ† (Ù†ÙØ³ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¨Ø§Ù„Ø£Ø¹Ù„Ù‰ Ù„Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„ØªØ±ØªÙŠØ¨)
        const firebaseKeys = places; // ÙŠÙ…ÙƒÙ† Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù†ÙØ³ Ø§Ù„Ù…ØµÙÙˆÙØ© Ù„Ø£Ù†Ù‡Ø§ Ù…ØªØ·Ø§Ø¨Ù‚Ø©

        let tbody = '';
        firebaseKeys.forEach((key, i) => {
          let p = perPlace[key] || {count:0, nassabaList:[], reps:{}, times:[]};
          
          let minTime = p.times.length ? new Date(Math.min(...p.times.map(t=>new Date(t)))) : '-';
          let maxTime = p.times.length ? new Date(Math.max(...p.times.map(t=>new Date(t)))) : '-';
          let diff = (minTime!='-' && maxTime!='-') ? ((maxTime-minTime)/60000) : null;
          let duration = (diff!==null)? `${Math.floor(diff/60)} Ø³ ${Math.floor(diff%60).toString().padStart(2,'0')} Ø¯`:'-';
          
          // ØªØ±ØªÙŠØ¨ Ø§Ù„Ù…Ù†Ø§Ø¯ÙŠØ¨ Ø­Ø³Ø¨ Ø§Ù„Ø£ÙƒØ«Ø± Ø¥Ø¯Ø®Ø§Ù„Ø§Ù‹
          let sortedReps = Object.entries(p.reps).sort((a, b) => b[1].length - a[1].length);

          let repDetails = sortedReps
            .map(([k,v]) => `
                <div class="rep-tag" onclick="showRepStat('${k}', ${v.length})">
                    <span>${k}</span>
                    <span class="statok">${v.length}</span>
                </div>
            `).join("");

          let nassabaCount = p.nassabaList.length;
          let nassabaClass = nassabaCount > 0 ? 'nassaba-cell' : 'zero-nassaba';
          let nassabaAction = nassabaCount > 0 ? `onclick="showNassabaDetails('${key}')"` : '';

          tbody += `<tr>
            <td><b>${i + 1}</b></td> 
            <td style="font-weight:bold; color:var(--primary-color)">${places[i]}</td>
            <td><span style="font-size:1.1em; font-weight:bold;">${p.count}</span></td>
            <td><span class="${nassabaClass}" ${nassabaAction}>${nassabaCount}</span></td>
            <td style="text-align:right; direction:rtl;">
                <div class="rep-list-container">${repDetails||'-'}</div>
            </td>
            <td dir="ltr">${minTime!='-' ? minTime.toLocaleTimeString('ar-EG', {hour:'2-digit', minute:'2-digit'}) : '-'}</td>
            <td dir="ltr">${maxTime!='-' ? maxTime.toLocaleTimeString('ar-EG', {hour:'2-digit', minute:'2-digit'}) : '-'}</td>
            <td>${duration}</td>
          </tr>`;
        });
        document.getElementById('tbody').innerHTML = tbody;
    }

    // Ø­ÙØ¸ Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø¯Ù…Ø¬
    window.saveMergeRules = function() {
        localStorage.setItem('repMergeRules', JSON.stringify(window.mergeMap));
        window.startListening(); // Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØªØºÙŠÙŠØ± ÙÙˆØ±Ø§Ù‹
        renderMergeList();
    }

    // Ø¥Ø¶Ø§ÙØ© Ù‚Ø§Ø¹Ø¯Ø© Ø¯Ù…Ø¬ Ø¬Ø¯ÙŠØ¯Ø©
    window.addMergeRule = function() {
        const fromName = document.getElementById('mergeFrom').value.trim();
        const toName = document.getElementById('mergeTo').value.trim();

        if(!fromName || !toName) {
            alert("ÙŠØ±Ø¬Ù‰ ÙƒØªØ§Ø¨Ø© Ø§Ù„Ø§Ø³Ù…ÙŠÙ† Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­");
            return;
        }
        if(fromName === toName) {
            alert("Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø¯Ù…Ø¬ Ø§Ù„Ø§Ø³Ù… Ù…Ø¹ Ù†ÙØ³Ù‡!");
            return;
        }

        window.mergeMap[fromName] = toName;
        document.getElementById('mergeFrom').value = '';
        document.getElementById('mergeTo').value = '';
        
        window.saveMergeRules();
        alert(`ØªÙ… Ø¯Ù…Ø¬ (${fromName}) Ù…Ø¹ (${toName}) Ø¨Ù†Ø¬Ø§Ø­!\nØ§Ù„Ø¢Ù† Ø³ÙŠØ¸Ù‡Ø± (${toName}) ÙÙ‚Ø· Ø¨Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ø£Ø±Ù‚Ø§Ù….`);
    }

    // Ø­Ø°Ù Ù‚Ø§Ø¹Ø¯Ø© Ø¯Ù…Ø¬
    window.removeMergeRule = function(fromName) {
        if(confirm(`Ù‡Ù„ ØªØ±ÙŠØ¯ Ø¥Ù„ØºØ§Ø¡ Ø¯Ù…Ø¬ (${fromName})ØŸ`)) {
            delete window.mergeMap[fromName];
            window.saveMergeRules();
        }
    }

    // Ø¹Ø±Ø¶ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© ÙÙŠ Ø§Ù„Ù€ Modal
    window.renderMergeList = function() {
        const list = document.getElementById('mergeListDisplay');
        list.innerHTML = '';
        
        for (let [from, to] of Object.entries(window.mergeMap)) {
            let li = document.createElement('li');
            li.innerHTML = `
                <div>
                    <span style="color:red; text-decoration:line-through;">${from}</span>
                    <span style="margin:0 10px;">â¬…ï¸</span>
                    <span style="font-weight:bold; color:green;">${to}</span>
                </div>
                <span class="delete-merge" onclick="removeMergeRule('${from}')">&times;</span>
            `;
            list.appendChild(li);
        }
    }

    // Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
    window.renderMergeList();

    // Ø¨Ù‚ÙŠØ© Ø§Ù„Ø¯ÙˆØ§Ù„
    window.resetData = async function() {
        if(confirm("ØªØ­Ø°ÙŠØ± Ù‡Ø§Ù…:\nÙ‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† ØªØµÙÙŠØ± Ø§Ù„Ø¹Ø¯Ø§Ø¯Ø§Øª ÙˆØ­Ø°Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† ÙˆØ§Ù„Ù†ØµØ§Ø¨Ø©ØŸ")) {
            const userPass = prompt("Ù„Ù„ØªØ£ÙƒÙŠØ¯ØŒ Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ù…Ø±Ø© Ø£Ø®Ø±Ù‰:");
            if(userPass === "521988"){
                try {
                    await remove(ref(db)); 
                    alert("ØªÙ… ØªØµÙÙŠØ± Ø§Ù„Ù†Ø¸Ø§Ù… Ø¨Ø§Ù„ÙƒØ§Ù…Ù„.");
                } catch(e) {
                    alert("Ø­Ø¯Ø« Ø®Ø·Ø£: " + e.message);
                }
            } else { alert("ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø®Ø§Ø·Ø¦Ø©."); }
        }
    };

    window.exportToExcel = function() {
        if(!window.allStats) { alert("Ø§Ù†ØªØ¸Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø£ÙˆÙ„Ø§Ù‹"); return; }
        let header = `<th style="border:1px solid #000;">Ù…</th><th style="border:1px solid #000;">Ø§Ù„Ù…ÙƒØ§Ù†</th><th style="border:1px solid #000;">Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„ÙƒÙ„ÙŠ</th><th style="border:1px solid #000;">Ù†ØµØ§Ø¨Ø©</th><th style="border:1px solid #000;">ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù†Ø§Ø¯ÙŠØ¨</th><th style="border:1px solid #000;">Ø£ÙˆÙ„ Ø¥Ø¯Ø®Ø§Ù„</th><th style="border:1px solid #000;">Ø¢Ø®Ø± Ø¥Ø¯Ø®Ø§Ù„</th><th style="border:1px solid #000;">Ø§Ù„Ù…Ø¯Ø©</th>`;
        let rows = '';
        firebaseKeys.forEach((key, index) => {
            let p = window.allStats[key] || {count:0, nassabaList:[], reps:{}, times:[]};
            let minTime = p.times.length ? new Date(Math.min(...p.times.map(t=>new Date(t)))).toLocaleTimeString('ar-EG') : '-';
            let maxTime = p.times.length ? new Date(Math.max(...p.times.map(t=>new Date(t)))).toLocaleTimeString('ar-EG') : '-';
            let diff = (minTime!='-' && maxTime!='-') ? ((new Date(Math.max(...p.times.map(t=>new Date(t)))) - new Date(Math.min(...p.times.map(t=>new Date(t)))))/60000) : null;
            let duration = (diff!==null)? `${Math.floor(diff/60)}:${Math.floor(diff%60)}`:'-';
            
            // ØªØ±ØªÙŠØ¨ Ø§Ù„Ù…Ù†Ø§Ø¯ÙŠØ¨ ÙÙŠ Ø§Ù„Ø¥ÙƒØ³Ù„ Ø£ÙŠØ¶Ø§Ù‹
            let repString = "";
            Object.entries(p.reps).sort((a,b)=>b[1].length-a[1].length).forEach(([name, times]) => { repString += `${name} (${times.length}) \n`; });
            
            rows += `<tr><td style="border:1px solid #000;">${index+1}</td><td style="border:1px solid #000;">${places[index]}</td><td style="border:1px solid #000;">${p.count}</td><td style="border:1px solid #000;">${p.nassabaList.length}</td><td style="border:1px solid #000; white-space:pre-wrap;">${repString}</td><td style="border:1px solid #000;">${minTime}</td><td style="border:1px solid #000;">${maxTime}</td><td style="border:1px solid #000;">${duration}</td></tr>`;
        });
        let excelFile = `<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><meta charset="UTF-8"></head><body dir="rtl"><table><thead><tr>${header}</tr></thead><tbody>${rows}</tbody></table></body></html>`;
        var blob = new Blob([excelFile], { type: 'application/vnd.ms-excel' });
        var link = document.createElement("a");
        link.href = URL.createObjectURL(blob);
        link.download = "Live_Report.xls";
        link.click();
    }
  </script>

  <script>
    // Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„Ù„ÙˆØ§Ø¬Ù‡Ø©
    function checkPassword() {
        if (document.getElementById('passwordInput').value === '521988') {
            document.getElementById('loginScreen').style.display = 'none';
            document.querySelector('.container').classList.add('visible');
            if(window.startListening) window.startListening();
        } else {
            document.getElementById('errorMsg').style.display = 'block';
        }
    }
    window.closeModal = function(id) { document.getElementById(id).style.display = 'none'; }
    window.onclick = function(e) { if(e.target.classList.contains('modal')) e.target.style.display='none'; }
    
    window.showRepStat = function(name, count) {
        document.getElementById('modalRepName').innerText = name;
        document.getElementById('modalRepCount').innerText = count;
        document.getElementById('repModal').style.display = 'flex';
    }

    window.showNassabaDetails = function(placeKey) {
        // Ù†ÙØ³ ÙƒÙˆØ¯ Ø¹Ø±Ø¶ Ø§Ù„Ù†ØµØ§Ø¨Ø©
        const places = [
            "Ø§Ù„Ù…Ù†Ø²Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© 1 - ÙƒØ±ÙŠÙ… Ø§Ù„Ù…Ø±ÙˆØ±", "Ø§Ù„Ù…Ù†Ø²Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© 2 - Ø´Ø±ÙŠÙ Ø§Ù„ØªØ£Ù…ÙŠÙ† Ø§Ù„ØµØ­ÙŠ", "Ø¨Ø­Ø± Ø§Ù„Ø¨Ù„Ø¯ Ø´Ø§Ø±Ø¹ Ø§Ù„ÙƒØ§Ø¨ØªÙ† - Ø´Ø±ÙŠÙ Ø§Ù„Ø¹Ø²Ø§Ø²ÙŠ", "Ù…Ø¯Ø±Ø³Ø© Ø¹Ø¨Ø¯ Ø§Ù„Ø¹Ø§Ù„ Ø´Ù„Ø¨ÙŠØ§ÙŠØ© - Ø§Ø´Ø±Ù Ø§Ù„Ø£Ø¨Ø§ØµÙŠØ±ÙŠ", "Ù…ØµÙ†Ø¹ Ø§Ù„Ø¨ØµÙ„ - ÙØ¤Ø§Ø¯ Ø­Ø§Ù„", "Ø§Ù„ÙƒÙØ± 1 - Ø¹Ù„ÙŠ Ø´Ø·Ø§", "Ø§Ù„ÙƒÙØ± 2 ØªØ­Øª Ø§Ù„Ø³ÙƒØ© - Ø¹Ø§Ø¯Ù„ Ø¬Ù„Ø§Ù„", "Ø³ÙˆÙ‚ Ø§Ù„Ø¬Ù…Ù„Ø© - Ø§Ù„Ø³Ø¹ÙŠØ¯ Ø´Ø·Ø§- Ø¹Ù„Ù‰ Ø§Ù„Ø¨ÙŠØ§Ø¹", "Ø§Ù„ÙØ¯Ø§Ø¡ 1 - Ø¹Ù…Ø± Ø§Ù„ÙƒÙŠØ§Ù„", "Ø§Ù„ÙØ¯Ø§Ø¡ 2 - Ø­Ù…Ø§Ø¯Ù‡ Ø§Ù„ÙƒÙŠØ§Ù„", "Ø§Ù„Ø­Ù…Ø²Ø§ÙˆÙŠ - Ø­Ù…Ø§Ø¯Ù‡ Ø§Ù„Ø³Ø±ÙŠ", "Ø§Ù„Ø¬Ø±Ù† 1 - Ø¨ÙˆØ¬ÙŠ Ø§Ù„Ø¨Ø±Ø¹ÙŠ", "Ø§Ù„Ø¬Ø±Ù† 2 - Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ… ÙÙ‡ÙŠØ¯", "Ø§Ù„Ø¨Ø± Ø§Ù„Ø«Ø§Ù†ÙŠ Ø­ÙŠ Ø§Ù„Ø³Ù„Ø§Ù… - ÙŠØ­ÙŠÙ‰ Ø­Ø¨Ù‚", "Ø­ÙŠ Ø§Ù„Ø£Ø¹Ø¬Ø§Ù… - Ø­Ù…Ø§Ø¯Ù‡ Ø§Ø¨Ùˆ Ø±Ø´Ø§Ø¯", "Ø§Ù„Ø¹Ø²Ø¨Ø© Ù…Ù†Ø´ÙŠØ© Ù†Ø§ØµØ± -Ø­Ø³Ø§Ù† Ø¹Ø·ÙŠØ©", "Ø§Ù„Ø·ÙˆÙŠÙ„ - Ø£Ø­Ù…Ø¯ Ø¹Ø¨Ø¯ Ø§Ù„Ø¹Ø¸ÙŠÙ…", "Ø§Ù„Ø¨Ø± Ø§Ù„Ø«Ø§Ù†ÙŠ 2 Ø§Ù„Ù‡Ø§ÙˆÙŠØ³ - Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ… Ø¹Ø¨Ø¯ Ø§Ù„Ù…Ø¬ÙŠØ¯", "Ø§Ù„ÙÙ‚Ø§Ø¹ÙŠ - Ù…Ø­Ù…Ø¯ Ø­Ø¨ÙŠØ¨", "Ø¨Ø­Ø± Ø§Ù„Ø¨Ù„Ø¯ 2 - Ø§Ù„Ø³ÙŠØ¯ Ø­Ø±Ø§Ø²", "Ø­ÙŠ Ø§Ù„Ø¬Ø¨Ø§Ù†Ø© - Ø³Ø¹Ø¯ Ø§Ù„Ø´Ù„ÙˆØ¯ÙŠ", "Ø§Ù„ÙƒÙØ± 3 Ø¨Ø¬ÙˆØ§Ø± Ù…Ù„Ø¹Ø¨ Ø¨Ø±Ø´Ù„ÙˆÙ†Ø© - Ù…Ø­Ù…Ø¯ Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©", "Ø£Ø¨Ùˆ Ø±Ø´Ø§Ø¯ Ù…Ù‚Ù‡Ù‰ Ø£Ø¨Ùˆ Ø³Ù„ÙŠÙ…Ø§Ù† - Ù…Ø­Ù…Ø¯ Ø±Ø´Ø§Ø¯", "Ø­ÙŠ Ø§Ù„Ø²Ù‡Ø±Ø§Ø¡ - Ø±Ø´Ø§Ø¯ Ø¹Ø¨Ø¯ Ø§Ù„ÙˆÙ‡Ø§Ø¨", "Ø¨Ø­Ø± Ø§Ù„Ø¨Ù„Ø¯ 3 - Ù…Ù†ØµÙˆØ± Ø§Ù„Ø¨Ø¯Ø±ÙŠ", "Ø­ÙŠ Ø§Ù„Ø³Ù„Ù…ÙˆÙ†ÙŠ - Ø­Ø³Ù† Ø§Ù„Ù…Ù†Ø§Ø®Ù„Ù‰", "Ø­Ù‰ Ù…Ø²Ù„ÙØ§Ù† Ø§Ù„Ø¹Ù„Ù…ÙŠ -Ø£Ø¨ÙˆØ¹Ù„Ø§Ø¡", "Ø­ÙŠ Ø§Ù„Ø¨ØµÙ„Ù‡ Ø­Ù…ÙˆØ¯-Ø¹Ø¨Ø¯ Ø§Ù„Ø­Ù…ÙŠØ¯", "Ø­Ù‰ Ø§Ù„Ø¬Ø±Ù† 3 -Ù‚Ù‡ÙˆØ© Ø§Ù„Ù†Ø¬Ø¯ÙŠ Ù…Ø­Ù…Ø¯ Ø§Ù„Ù†Ø¬Ø¯ÙŠ"
        ];
        const placeIndex = places.indexOf(placeKey);
        const placeName = placeIndex !== -1 ? places[placeIndex] : placeKey;
        if(!window.allStats || !window.allStats[placeKey]) return;
        const list = window.allStats[placeKey].nassabaList;
        const container = document.getElementById('nassabaListContainer');
        document.getElementById('nassabaPlaceName').innerText = placeName;
        container.innerHTML = '';
        list.forEach(item => {
            let date = new Date(item.time).toLocaleTimeString('ar-EG');
            let li = document.createElement('li');
            li.innerHTML = `
                <div style="background:#fff0f0; padding:10px; margin-bottom:5px; border-radius:5px; border:1px solid #ffcccc;">
                    <div style="display:flex; justify-content:space-between;">
                        <span>ğŸ†” <b>${item.id}</b></span>
                    </div>
                    <span style="font-size:0.85em; color:#666;">Ø¨ÙˆØ§Ø³Ø·Ø©: ${item.by} | ${date}</span>
                </div>`;
            container.appendChild(li);
        });
        document.getElementById('nassabaModal').style.display = 'flex';
    }
  </script>
</body>
</html>
