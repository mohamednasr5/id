<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>قارئ بطاقة + رخصة</title>
  <script src="https://cdn.jsdelivr.net/npm/dynamsoft-barcode-reader-bundle@11.2.4000/dist/dbr.bundle.js"></script>
</head>
<body>
  <h2>Scan ID / Driver License</h2>
  <div id="camera-view"></div>
  <pre id="result"></pre>

  <script>
    (async ()=>{
      // 1. تهيئة الماسح مع الترخيص
      const scanner = new Dynamsoft.BarcodeScanner({
        license: "DLS2eyJoYW5kc2hha2VDb2RlIjoiMTA0ODY2MTM2LU1UQTBPRFkyTVRNMkxYZGxZaTFVY21saGJGQnliMm8iLCJtYWluU2VydmVyVVJMIjoiaHR0cHM6Ly9tZGxzLmR5bmFtc29mdG9ubGluZS5jb20iLCJvcmdhbml6YXRpb25JRCI6IjEwNDg2NjEzNiIsInN0YW5kYnlTZXJ2ZXJVUkwiOiJodHRwczovL3NkbHMuZHluYW1zb2Z0b25saW5lLmNvbSIsImNoZWNrQ29kZSI6LTE3MDIzNzIyNzh9"
      });

      await scanner.open();  // يفتح الكاميرا

      // 2. قراءة
      const result = await scanner.scan();  // ينتظر قراءة الباركود

      if (result.barcodeResults.length > 0) {
        const txt = result.barcodeResults[0].text;
        console.log("Raw barcode text:", txt);

        // 3. لو البيانات مش منظمة — parse البيانات
        // (إذا الباركود PDF417 يحتوي JSON أو تنسيق قابل للتحليل)
        document.getElementById("result").innerText = txt;
      } else {
        alert("لم يتم قراءة باركود!");
      }
    })();
  </script>
</body>
</html>
