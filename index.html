<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
Â  <meta charset="UTF-8">
Â  <title>ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨</title>
Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap">
Â  <style>
Â  Â  :root {
Â  Â  Â  --primary-color: #0072ff;
Â  Â  Â  --secondary-color: #00c6ff;
Â  Â  Â  --bg-gradient: linear-gradient(135deg, #00c6ff 0%, #0072ff 100%);
Â  Â  Â  --glass-bg: rgba(255, 255, 255, 0.95);
Â  Â  Â  --glass-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.2);
Â  Â  Â  --input-bg: #f0f4f8;
Â  Â  Â  --text-color: #2d3436;
Â  Â  Â  --error-color: #e74c3c;
Â  Â  Â  --success-color: #2ecc71;
Â  Â  }

Â  Â  * { box-sizing: border-box; outline: none; }

Â  Â  body {
Â  Â  Â  font-family: 'Cairo', sans-serif;
Â  Â  Â  margin: 0; padding: 0;
Â  Â  Â  min-height: 100vh;
Â  Â  Â  display: flex; align-items: center; justify-content: center;
Â  Â  Â  background: var(--bg-gradient);
Â  Â  Â  background-size: 400% 400%;
Â  Â  Â  animation: gradientBG 15s ease infinite;
Â  Â  Â  overflow: hidden;
Â  Â  Â  color: var(--text-color);
Â  Â  Â  position: fixed;
Â  Â  Â  width: 100%;
Â  Â  Â  height: 100%;
Â  Â  }

Â  Â  @keyframes gradientBG {
Â  Â  Â  0% { background-position: 0% 50%; }
Â  Â  Â  50% { background-position: 100% 50%; }
Â  Â  Â  100% { background-position: 0% 50%; }
Â  Â  }

Â  Â  .circles { position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; z-index: -1; }
Â  Â  .circles li { position: absolute; display: block; list-style: none; width: 20px; height: 20px; background: rgba(255, 255, 255, 0.2); animation: animate 25s linear infinite; bottom: -150px; border-radius: 50%; }
Â  Â  .circles li:nth-child(1){ left: 25%; width: 80px; height: 80px; animation-delay: 0s; }
Â  Â  .circles li:nth-child(2){ left: 10%; width: 20px; height: 20px; animation-delay: 2s; animation-duration: 12s; }
Â  Â  .circles li:nth-child(3){ left: 70%; width: 20px; height: 20px; animation-delay: 4s; }
Â  Â  .circles li:nth-child(4){ left: 40%; width: 60px; height: 60px; animation-delay: 0s; animation-duration: 18s; }
Â  Â  .circles li:nth-child(5){ left: 65%; width: 20px; height: 20px; animation-delay: 0s; }
Â  Â  @keyframes animate { 0%{ transform: translateY(0) rotate(0deg); opacity: 1; border-radius: 0; } 100%{ transform: translateY(-1000px) rotate(720deg); opacity: 0; border-radius: 50%; } }

Â  Â  .container { position: relative; z-index: 1; perspective: 1000px; width: 100%; padding: 10px; display: flex; align-items: center; justify-content: center; }

Â  Â  .card {
Â  Â  Â  background: var(--glass-bg);
Â  Â  Â  backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px);
Â  Â  Â  border-radius: 20px; padding: 30px 25px;
Â  Â  Â  width: 100%; max-width: 420px;
Â  Â  Â  box-shadow: var(--glass-shadow);
Â  Â  Â  border: 1px solid rgba(255, 255, 255, 0.18);
Â  Â  Â  transform: translateY(20px); opacity: 0;
Â  Â  Â  animation: fadeInUp 0.8s cubic-bezier(0.2, 0.8, 0.2, 1) forwards;
Â  Â  Â  transition: all 0.5s ease;
Â  Â  Â  max-height: calc(100vh - 40px);
Â  Â  Â  overflow-y: auto;
Â  Â  Â  overflow-x: hidden;
Â  Â  Â  scrollbar-width: none;
Â  Â  Â  -ms-overflow-style: none;
Â  Â  }
Â  Â  .card::-webkit-scrollbar { display: none; }
Â  Â  @keyframes fadeInUp { to { opacity: 1; transform: translateY(0); } }

Â  Â  h2 { text-align: center; margin-bottom: 20px; color: var(--primary-color); font-weight: 700; font-size: 22px; }
Â  Â  h3 { text-align: right; color: #333; margin: 12px 0 8px; font-size: 16px; border-bottom: 2px solid #eee; padding-bottom: 5px;}

Â  Â  .input-group { position: relative; margin-bottom: 18px; }

Â  Â  /* ØªÙ… Ø¥Ø¨Ù‚Ø§Ø¡ Ù‡Ø°Ø§ Ø§Ù„ÙƒÙ„Ø§Ø³ ÙÙŠ Ø­Ø§Ù„ Ø£Ø±Ø¯Øª Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡ Ù„Ø§Ø­Ù‚Ø§Ù‹ Ù„ÙƒÙ†Ù‡ ØºÙŠØ± Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¢Ù† ÙÙŠ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ */
Â  Â  .fixed-input-box {
Â  Â  Â  display: flex; align-items: center; background: var(--input-bg);
Â  Â  Â  border-radius: 10px; padding: 0 15px; border: 2px solid transparent;
Â  Â  Â  transition: 0.3s ease; direction: ltr;
Â  Â  }
Â  Â  .fixed-input-box:focus-within { background: #fff; border-color: var(--secondary-color); box-shadow: 0 0 15px rgba(0, 198, 255, 0.1); }
Â  Â  .static-x { color: #aaa; font-weight: bold; font-size: 18px; letter-spacing: 2px; margin-right: 5px; pointer-events: none; user-select: none; }
Â  Â Â 
Â  Â  input, select {
Â  Â  Â  width: 100%; padding: 12px 15px; font-size: 16px;
Â  Â  Â  background: var(--input-bg); border: 2px solid transparent;
Â  Â  Â  border-radius: 10px; font-family: 'Cairo', sans-serif;
Â  Â  Â  transition: 0.3s ease; color: #333;
Â  Â  }
Â  Â  /* ØªØ¹Ø¯ÙŠÙ„ ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ù€ input Ù„ÙŠÙƒÙˆÙ† Ø·Ø¨ÙŠØ¹ÙŠØ§Ù‹ Ø¨Ø¯ÙˆÙ† Ø®ØµØ§Ø¦Øµ Ø§Ù„Ù€ fixed-box Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© */
Â  Â  input:focus { background: #fff; border-color: var(--secondary-color); box-shadow: 0 0 15px rgba(0, 198, 255, 0.1); }

Â  Â  .input-group label {
Â  Â  Â  position: absolute; top: 50%; right: 15px; transform: translateY(-50%);
Â  Â  Â  font-size: 16px; color: #999; pointer-events: none;
Â  Â  Â  transition: 0.3s ease all; padding: 0 5px; background: transparent; z-index: 10;
Â  Â  }
Â  Â  input:focus ~ label, input:not(:placeholder-shown) ~ label {
Â  Â  Â  top: 0; transform: translateY(-50%) scale(0.85);
Â  Â  Â  background: #fff; color: var(--primary-color); font-weight: 600; border-radius: 5px;
Â  Â  }

Â  Â  .id-card-visual-container {
Â  Â  Â  text-align: center; margin: 8px 0 15px 0; perspective: 800px;Â 
Â  Â  }
Â  Â  .id-card-img {
Â  Â  Â  max-width: 75%; height: auto; border-radius: 12px;
Â  Â  Â  box-shadow: 0 12px 28px rgba(0, 114, 255, 0.2);
Â  Â  Â  border: 2px solid rgba(255, 255, 255, 0.6);
Â  Â  Â  animation: floatCard 4s ease-in-out infinite;
Â  Â  Â  transform-style: preserve-3d; transition: transform 0.3s ease;
Â  Â  }
Â  Â  @keyframes floatCard {
Â  Â  Â  0%, 100% { transform: translateY(0) rotateX(0deg); }
Â  Â  Â  50% { transform: translateY(-8px) rotateX(5deg); }
Â  Â  }

Â  Â  .btn {
Â  Â  Â  background: linear-gradient(to right, var(--secondary-color), var(--primary-color));
Â  Â  Â  color: white; padding: 11px; width: 100%; border: none;
Â  Â  Â  border-radius: 50px; font-size: 16px; font-weight: 700; cursor: pointer;
Â  Â  Â  transition: 0.3s ease; box-shadow: 0 5px 15px rgba(0, 114, 255, 0.3);
Â  Â  Â  position: relative; overflow: hidden;
Â  Â  }
Â  Â  .btn:hover { transform: translateY(-2px); box-shadow: 0 8px 20px rgba(0, 114, 255, 0.4); }
Â  Â  .btn:active { transform: translateY(1px); }

Â  Â  .btn-secondary { background: linear-gradient(to right, #43cea2, #185a9d); margin-top: 10px; }
Â  Â  .btn-danger { background: linear-gradient(to right, #ff416c, #ff4b2b); margin-top: 10px; }
Â  Â  .btn-warning { background: linear-gradient(to right, #f2994a, #f2c94c); color: #333; margin-top: 5px; }

Â  Â  .msg { margin-top: 12px; text-align: center; font-size: 13px; font-weight: 600; min-height: 18px; transition: 0.3s; padding: 8px; border-radius: 8px; }
Â  Â  .msg.error { color: var(--error-color); animation: shake 0.5s; }
Â  Â  .msg.success { color: var(--success-color); }

Â  Â  .duplicate-box {
Â  Â  Â  Â  background-color: #fff5f5; border: 2px solid #ff0000; color: #c0392b;
Â  Â  Â  Â  padding: 12px; border-radius: 10px; margin-top: 15px; font-weight: bold;
Â  Â  Â  Â  box-shadow: 0 4px 15px rgba(255, 0, 0, 0.2);
Â  Â  Â  Â  animation: pulseRed 0.8s infinite alternate;
Â  Â  Â  Â  display: flex; flex-direction: column; align-items: center; justify-content: center;
Â  Â  Â  Â  font-size: 13px;
Â  Â  }
Â  Â  @keyframes pulseRed { from { border-color: #ff0000; box-shadow: 0 0 10px rgba(255, 0, 0, 0.3); } to { border-color: #ff6b6b; box-shadow: 0 0 20px rgba(255, 0, 0, 0.6); } }
Â  Â  @keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(10px); } 75% { transform: translateX(-10px); } }

Â  Â  /* --- Ø³ØªØ§ÙŠÙ„ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†Ø§Ø¯ÙŠØ¨ ÙÙŠ Ù„ÙˆØ­Ø© Ø§Ù„Ø£Ø¯Ù…Ù† --- */
Â  Â  .admin-list-container {
Â  Â  Â  Â  max-height: 200px;
Â  Â  Â  Â  overflow-y: auto;
Â  Â  Â  Â  margin-bottom: 15px;
Â  Â  Â  Â  border: 1px solid #ddd;
Â  Â  Â  Â  border-radius: 10px;
Â  Â  Â  Â  background: rgba(255,255,255,0.5);
Â  Â  Â  Â  scrollbar-width: thin;
Â  Â  Â  Â  scrollbar-color: #0072ff #f0f4f8;
Â  Â  }
Â  Â  .admin-list-container::-webkit-scrollbar { width: 6px; }
Â  Â  .admin-list-container::-webkit-scrollbar-track { background: #f0f4f8; border-radius: 10px; }
Â  Â  .admin-list-container::-webkit-scrollbar-thumb { background: #0072ff; border-radius: 10px; }
Â  Â  .rep-item {
Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  justify-content: space-between;
Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  padding: 10px;
Â  Â  Â  Â  border-bottom: 1px solid #eee;
Â  Â  Â  Â  transition: 0.2s;
Â  Â  }
Â  Â  .rep-item:last-child { border-bottom: none; }
Â  Â  .rep-item:hover { background: rgba(255,255,255,0.8); }
Â  Â  .rep-name { font-weight: 600; color: #333; }
Â  Â  .btn-delete-rep {
Â  Â  Â  Â  background: #ff4b2b;
Â  Â  Â  Â  color: white;
Â  Â  Â  Â  border: none;
Â  Â  Â  Â  padding: 5px 12px;
Â  Â  Â  Â  border-radius: 15px;
Â  Â  Â  Â  font-size: 12px;
Â  Â  Â  Â  cursor: pointer;
Â  Â  }
Â  Â  .btn-delete-rep:hover { background: #d32f2f; }
Â  Â  .empty-list { text-align: center; padding: 20px; color: #888; font-size: 14px; }

Â  Â  @media (max-width: 480px) {Â 
Â  Â  Â  .card { padding: 25px 18px; margin: 15px; width: 95%; max-width: 100%; }Â 
Â  Â  Â  h2 { font-size: 18px; margin-bottom: 15px; }Â 
Â  Â  Â  h3 { font-size: 15px; }
Â  Â  Â  .btn { font-size: 15px; padding: 10px; }
Â  Â  Â  .input-group { margin-bottom: 15px; }
Â  Â  Â  input, select { font-size: 15px; padding: 10px 12px; }
Â  Â  Â  .id-card-img { max-width: 70%; }
Â  Â  Â  .msg { font-size: 12px; }
Â  Â  }
Â  Â  @media (max-width: 360px) {Â 
Â  Â  Â  .card { padding: 20px 15px; }
Â  Â  Â  h2 { font-size: 16px; }
Â  Â  Â  .btn { font-size: 14px; }
Â  Â  }
Â  Â  @media (max-height: 600px) {
Â  Â  Â  .card { padding: 20px 20px; }
Â  Â  Â  h2 { margin-bottom: 12px; font-size: 18px; }
Â  Â  Â  .input-group { margin-bottom: 12px; }
Â  Â  Â  .btn { padding: 9px; font-size: 15px; }
Â  Â  Â  .id-card-visual-container { margin: 5px 0 10px 0; }
Â  Â  Â  .id-card-img { max-width: 65%; }
Â  Â  Â  .admin-list-container { max-height: 150px; }
Â  Â  }
Â  Â  .hidden { display: none; }
Â  Â  .fade-in { animation: fadeIn 0.5s forwards; }
Â  Â  @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
Â  </style>
</head>
<body>

Â  <audio id="errorSound" src="https://actions.google.com/sounds/v1/alarms/beep_short.ogg" preload="auto"></audio>

Â  <ul class="circles"><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul>

Â  <div class="container">
Â  Â Â 
Â  Â  <div class="card" id="auth-card">
Â  Â  Â  <h2>ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨</h2>
Â  Â  Â  <div class="input-group">
Â  Â  Â  Â  <input id="loginCode" type="number" placeholder=" ">
Â  Â  Â  Â  <label for="loginCode">ÙƒÙˆØ¯ Ø§Ù„Ø¯Ø®ÙˆÙ„</label>
Â  Â  Â  </div>
Â  Â  Â  <button class="btn" onclick="login()"><span>Ø¯Ø®ÙˆÙ„</span></button>
Â  Â  Â  <div id="login-msg" class="msg"></div>
Â  Â  </div>

Â  Â  <div class="card hidden" id="main-card">
Â  Â  Â  <h2 id="welcome">Ù…Ø±Ø­Ø¨Ù‹Ø§</h2>
Â  Â  Â Â 
Â  Â  Â  <div class="input-group">
Â  Â  Â  Â  <input id="repName" type="text" autocomplete="off" list="repNamesHistory" maxlength="30" placeholder=" ">
Â  Â  Â  Â  <datalist id="repNamesHistory"></datalist>
Â  Â  Â  Â  <label for="repName">Ø§Ø³Ù… Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨</label>
Â  Â  Â  </div>
Â  Â  Â Â 
Â  Â  Â  <div class="input-group" style="margin-bottom: 5px;">
Â  Â  Â  Â  <input id="natID" type="tel" maxlength="14" placeholder=" " autocomplete="off">
Â  Â  Â  Â  <label for="natID">Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù‚ÙˆÙ…ÙŠ (14 Ø±Ù‚Ù…)</label>
Â  Â  Â  </div>

Â  Â  Â  <div class="id-card-visual-container">
Â  Â  Â  Â  <img src="https://raw.githubusercontent.com/mohamednasr5/id/e83438329b0f009f6eebf61b2797496d744589f2/5.png" alt="Ù…Ø«Ø§Ù„ Ù„Ù„Ø¨Ø·Ø§Ù‚Ø©" class="id-card-img">
Â  Â  Â  </div>
Â  Â  Â Â 
Â  Â  Â  <button class="btn" onclick="addUser()">Ø¥Ø¶Ø§ÙØ©</button>
Â  Â  Â  <div id="add-msg" class="msg"></div>
Â  Â  Â  <button class="btn btn-secondary" onclick="showStatsLogin()">Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© / Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª</button>
Â  Â  </div>

Â  Â  <div class="card hidden" id="stats-auth-card">
Â  Â  Â  <h2>ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„Ù…Ø¯ÙŠØ±</h2>
Â  Â  Â  <p style="text-align: center; color: #666; margin-bottom: 20px;">Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</p>
Â  Â  Â  <div class="input-group">
Â  Â  Â  Â  <input id="statsPass" type="password" placeholder=" ">
Â  Â  Â  Â  <label for="statsPass">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
Â  Â  Â  </div>
Â  Â  Â  <button class="btn" onclick="verifyStats()">Ø¯Ø®ÙˆÙ„</button>
Â  Â  Â  <div id="stats-msg" class="msg"></div>
Â  Â  Â  <button class="btn btn-danger" onclick="cancelStats()">Ø¥Ù„ØºØ§Ø¡ ÙˆØ¹ÙˆØ¯Ø©</button>
Â  Â  </div>

Â  Â  <div class="card hidden" id="admin-panel-card">
Â  Â  Â  Â  <h2>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</h2>
Â  Â  Â  Â Â 
Â  Â  Â  Â  <button class="btn btn-warning" onclick="location.href='stats.html'">Ø¹Ø±Ø¶ ØµÙØ­Ø© Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ÙƒØ§Ù…Ù„Ø© ğŸ“Š</button>
Â  Â  Â  Â Â 
Â  Â  Â  Â  <h3>Ø¥Ø¯Ø§Ø±Ø© Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ù…Ù†Ø§Ø¯ÙŠØ¨</h3>
Â  Â  Â  Â  <p style="font-size:12px; color:#666; text-align:right; margin-bottom:10px;">
Â  Â  Â  Â  Â  Â  ØªÙ†Ø¨ÙŠÙ‡: Ø­Ø°Ù Ø§Ù„Ø§Ø³Ù… Ù…Ù† Ù‡Ù†Ø§ ÙŠØ²ÙŠÙ„Ù‡ Ù…Ù† Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª ÙÙ‚Ø·. Ù„Ø§ ÙŠØªÙ… Ø­Ø°Ù Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³Ø¬Ù„Ø©.
Â  Â  Â  Â  </p>

Â  Â  Â  Â  <div class="admin-list-container" id="adminRepList">
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <button class="btn btn-danger" onclick="closeAdminPanel()">Ø®Ø±ÙˆØ¬ Ù…Ù† Ø§Ù„Ù„ÙˆØ­Ø©</button>
Â  Â  </div>

Â  </div>

Â  <script type="module">
Â  Â  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
Â  Â  import { getDatabase, ref, set, get, child, push } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js";

Â  Â  const firebaseConfig = {
Â  Â  Â  apiKey: "AIzaSyAxnIxtFeAOjYjCIrU5cwYVteuQ18K8Kjc",
Â  Â  Â  authDomain: "idmanazla.firebaseapp.com",
Â  Â  Â  databaseURL: "https://idmanazla-default-rtdb.europe-west1.firebasedatabase.app",
Â  Â  Â  projectId: "idmanazla",
Â  Â  Â  storageBucket: "idmanazla.firebasestorage.app",
Â  Â  Â  messagingSenderId: "408446131276",
Â  Â  Â  appId: "1:408446131276:web:976ae54181b5398de5a8e9",
Â  Â  Â  measurementId: "G-9YSW9HNYTG"
Â  Â  };
Â  Â  const app = initializeApp(firebaseConfig);
Â  Â  const db = getDatabase(app);

Â  Â  const places = [
Â  Â  Â  "Ø§Ù„Ù…Ù†Ø²Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© 1 - ÙƒØ±ÙŠÙ… Ø§Ù„Ù…Ø±ÙˆØ±",
Â  Â  Â  "Ø§Ù„Ù…Ù†Ø²Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© 2 - Ø´Ø±ÙŠÙ Ø§Ù„ØªØ£Ù…ÙŠÙ† Ù„ØµØ­ÙŠ",
Â  Â  Â  "Ø¨Ø­Ø± Ø§Ù„Ø¨Ù„Ø¯ Ø´Ø§Ø±Ø¹ Ø§Ù„ÙƒØ§Ø¨ØªÙ† - Ø´Ø±ÙŠÙ Ø§Ù„Ø¹Ø²Ø§Ø²ÙŠ",
Â  Â  Â  "Ù…Ø¯Ø±Ø³Ø© Ø¹Ø¨Ø¯ Ø§Ù„Ø¹Ø§Ù„ Ø´Ù„Ø¨ÙŠØ§ÙŠØ© - Ø§Ø´Ø±Ù Ø§Ù„Ø£Ø¨Ø§ØµÙŠØ±ÙŠ",
Â  Â  Â  "Ù…ØµÙ†Ø¹ Ø§Ù„Ø¨ØµÙ„ - ÙØ¤Ø§Ø¯ Ø­Ø§Ù„",
Â  Â  Â  "Ø§Ù„ÙƒÙØ± 1 - Ø¹Ù„ÙŠ Ø´Ø·Ø§",
Â  Â  Â  "Ø§Ù„ÙƒÙØ± 2 ØªØ­Øª Ø§Ù„Ø³ÙƒØ© - Ø±Ø§Ø¨Ø­ Ø´Ø·Ø§",
Â  Â  Â  "Ø³ÙˆÙ‚ Ø§Ù„Ø¬Ù…Ù„Ø© - Ø§Ù„Ø³Ø¹ÙŠØ¯ Ø´Ø·Ø§",
Â  Â  Â  "Ø§Ù„ÙØ¯Ø§Ø¡ 1 - Ø¹Ù…Ø± Ø§Ù„ÙƒÙŠØ§Ù„",
Â  Â  Â  "Ø§Ù„ÙØ¯Ø§Ø¡ 2 - Ø­Ù…Ø§Ø¯Ù‡ Ø§Ù„ÙƒÙŠØ§Ù„",
Â  Â  Â  "Ø§Ù„Ø­Ù…Ø²Ø§ÙˆÙŠ - Ø­Ù…Ø§Ø¯Ù‡ Ø§Ù„Ø´Ø±ÙŠ",
Â  Â  Â  "Ø§Ù„Ø¬Ø±Ù† 1 - Ø¨ÙˆØ¬ÙŠ Ø§Ù„Ø¨Ø±Ø¹ÙŠ",
Â  Â  Â  "Ø§Ù„Ø¬Ø±Ù† 2 - Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ… ÙÙ‡ÙŠØ¯",
Â  Â  Â  "Ø§Ù„Ø¨Ø± Ø§Ù„Ø«Ø§Ù†ÙŠ Ø­ÙŠ Ø§Ù„Ø³Ù„Ø§Ù… - ÙŠØ­ÙŠÙ‰ Ø­Ø¨Ù‚",
Â  Â  Â  "Ø­ÙŠ Ø§Ù„Ø£Ø¹Ø¬Ø§Ù… - Ù…Ø­Ù…Ø¯ Ø£Ø¨Ùˆ Ø±Ø¬Ø¨",
Â  Â  Â  "Ø§Ù„Ø¹Ø²Ø¨Ø© Ù…Ù†Ø´ÙŠØ© Ù†Ø§ØµØ± - Ø£ÙŠÙ…Ù† Ù‚Ù†Ø¯ÙŠÙ„",
Â  Â  Â  "Ø§Ù„Ø·ÙˆÙŠÙ„ - Ø£Ø­Ù…Ø¯ Ø¹Ø¨Ø¯ Ø§Ù„Ø¹Ø¸ÙŠÙ…",
Â  Â  Â  "Ø§Ù„Ø¨Ø± Ø§Ù„Ø«Ø§Ù†ÙŠ 2 Ø§Ù„Ù‡Ø§ÙˆÙŠØ³ - Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ… Ø¹Ø¨Ø¯ Ø§Ù„Ù…Ø¬ÙŠØ¯",
Â  Â  Â  "Ø§Ù„ÙÙ‚Ø§Ø¹ÙŠ - Ù…Ø­Ù…Ø¯ Ø­Ø¨ÙŠØ¨",
Â  Â  Â  "Ø¨Ø­Ø± Ø§Ù„Ø¨Ù„Ø¯ 2 - Ø§Ù„Ø³ÙŠØ¯ Ø­Ø±Ø§Ø²",
Â  Â  Â  "Ø­ÙŠ Ø§Ù„Ø¬Ø¨Ø§Ù†Ø© - Ø³Ø¹Ø¯ Ø§Ù„Ø´Ù„ÙˆØ¯ÙŠ",
Â  Â  Â  "Ø§Ù„ÙƒÙØ± 3 Ø¨Ø¬ÙˆØ§Ø± Ù…Ù„Ø¹Ø¨ Ø¨Ø±Ø´Ù„ÙˆÙ†Ø© - Ù…Ø­Ù…Ø¯ Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©",
Â  Â  Â  "Ø£Ø¨Ùˆ Ø±Ø´Ø§Ø¯ Ù…Ù‚Ù‡Ù‰ Ø£Ø¨Ùˆ Ø³Ù„ÙŠÙ…Ø§Ù† - Ù…Ø­Ù…Ø¯ Ø±Ø´Ø§Ø¯",
Â  Â  Â  "Ø­ÙŠ Ø§Ù„Ø²Ù‡Ø±Ø§Ø¡ - Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ø¹ÙŠØ¯",
Â  Â  Â  "Ø¨Ø­Ø± Ø§Ù„Ø¨Ù„Ø¯ 3 - Ù…Ù†ØµÙˆØ± Ø§Ù„Ø¨Ø¯Ø±ÙŠ"
Â  Â  ];

Â  Â  let userPlace = null, userPlaceIdx = null, userID = null;

Â  Â  // --- Ø¯ÙˆØ§Ù„ Ø­ÙØ¸ ÙˆØ§Ø³ØªØ±Ø¬Ø§Ø¹ Ø§Ù„Ø£Ø³Ù…Ø§Ø¡ ---
Â  Â  function loadRepNames() {
Â  Â  Â  Â  const stored = JSON.parse(localStorage.getItem('saved_rep_names') || '[]');
Â  Â  Â  Â  const datalist = document.getElementById('repNamesHistory');
Â  Â  Â  Â  datalist.innerHTML = '';
Â  Â  Â  Â  stored.forEach(name => {
Â  Â  Â  Â  Â  Â  const opt = document.createElement('option');
Â  Â  Â  Â  Â  Â  opt.value = name;
Â  Â  Â  Â  Â  Â  datalist.appendChild(opt);
Â  Â  Â  Â  });
Â  Â  }

Â  Â  function saveRepName(name) {
Â  Â  Â  Â  if(!name) return;
Â  Â  Â  Â  let stored = JSON.parse(localStorage.getItem('saved_rep_names') || '[]');
Â  Â  Â  Â  if (!stored.includes(name)) {
Â  Â  Â  Â  Â  Â  stored.push(name);
Â  Â  Â  Â  Â  Â  localStorage.setItem('saved_rep_names', JSON.stringify(stored));
Â  Â  Â  Â  Â  Â  loadRepNames();Â 
Â  Â  Â  Â  }
Â  Â  }
Â  Â  // ------------------------------

Â  Â  // --- Ø¯ÙˆØ§Ù„ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… (Admin Logic) ---
Â  Â  function renderAdminRepList() {
Â  Â  Â  Â  const container = document.getElementById('adminRepList');
Â  Â  Â  Â  const stored = JSON.parse(localStorage.getItem('saved_rep_names') || '[]');
Â  Â  Â  Â  container.innerHTML = '';

Â  Â  Â  Â  if (stored.length === 0) {
Â  Â  Â  Â  Â  Â  container.innerHTML = '<div class="empty-list">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ø³Ù…Ø§Ø¡ Ù…Ø­ÙÙˆØ¸Ø© Ø­Ø§Ù„ÙŠØ§Ù‹</div>';
Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  }

Â  Â  Â  Â  stored.forEach(name => {
Â  Â  Â  Â  Â  Â  const div = document.createElement('div');
Â  Â  Â  Â  Â  Â  div.className = 'rep-item';
Â  Â  Â  Â  Â  Â  div.innerHTML = `
Â  Â  Â  Â  Â  Â  Â  Â  <span class="rep-name">${name}</span>
Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn-delete-rep" onclick="window.deleteRepName('${name}')">Ø­Ø°Ù</button>
Â  Â  Â  Â  Â  Â  `;
Â  Â  Â  Â  Â  Â  container.appendChild(div);
Â  Â  Â  Â  });
Â  Â  }

Â  Â  window.deleteRepName = function(nameToDelete) {
Â  Â  Â  Â  if(confirm(`Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨ "${nameToDelete}" Ù…Ù† Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§ØªØŸ`)) {
Â  Â  Â  Â  Â  Â  let stored = JSON.parse(localStorage.getItem('saved_rep_names') || '[]');
Â  Â  Â  Â  Â  Â  stored = stored.filter(n => n !== nameToDelete);
Â  Â  Â  Â  Â  Â  localStorage.setItem('saved_rep_names', JSON.stringify(stored));
Â  Â  Â  Â  Â  Â  renderAdminRepList();
Â  Â  Â  Â  Â  Â  loadRepNames();Â 
Â  Â  Â  Â  }
Â  Â  }
Â  Â Â 
Â  Â  window.closeAdminPanel = function() {
Â  Â  Â  Â  document.getElementById('admin-panel-card').classList.add('hidden');
Â  Â  Â  Â  document.getElementById('main-card').classList.remove('hidden');
Â  Â  }
Â  Â  // ------------------------------

Â  Â  window.login = function() {
Â  Â  Â  const msgDiv = document.getElementById('login-msg');
Â  Â  Â  msgDiv.textContent = ''; msgDiv.className = 'msg';
Â  Â  Â  const codeInput = document.getElementById('loginCode').value.trim();
Â  Â  Â  const code = parseInt(codeInput);

if (!codeInput || isNaN(code) || code < 225501 || code > 225525) {
Â  Â  Â  Â  msgDiv.textContent = 'ÙƒÙˆØ¯ Ø§Ù„Ø¯Ø®ÙˆÙ„ ØºÙŠØ± ØµØ­ÙŠØ­.';
Â  Â  Â  Â  msgDiv.classList.add('error'); return;
Â  Â  Â  }
Â  Â  Â  let idx = code - 225501;
Â  Â  Â  if (idx >= places.length) {
Â  Â  Â  Â  Â  msgDiv.textContent = 'ÙƒÙˆØ¯ ØµØ­ÙŠØ­ ÙˆÙ„ÙƒÙ† Ø§Ù„Ù…ÙƒØ§Ù† ØºÙŠØ± Ù…Ø¹Ø±Ù Ø¨Ø§Ù„Ù†Ø¸Ø§Ù….';
Â  Â  Â  Â  Â  msgDiv.classList.add('error'); return;
Â  Â  Â  }
Â  Â  Â  userPlace = places[idx];
Â  Â  Â  userPlaceIdx = idx + 1;
Â  Â  Â  userID = codeInput;

Â  Â  Â  const authCard = document.getElementById('auth-card');
Â  Â  Â  const mainCard = document.getElementById('main-card');
Â  Â  Â  authCard.style.opacity = '0';
Â  Â  Â  authCard.style.transform = 'translateY(-20px)';
Â  Â  Â Â 
Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  authCard.classList.add('hidden');
Â  Â  Â  Â  mainCard.classList.remove('hidden');
Â  Â  Â  Â  mainCard.classList.add('fade-in');
Â  Â  Â  Â  document.getElementById('welcome').textContent = `Ù…Ø±Ø­Ø¨Ù‹Ø§ ÙÙŠ ${userPlace}`;
Â  Â  Â  Â  loadRepNames();Â 
Â  Â  Â  }, 400);
Â  Â  }

Â  Â  window.addUser = async function() {
Â  Â  Â  const btn = event.target;
Â  Â  Â  const originalText = btn.innerText;
Â  Â  Â  let name = document.getElementById('repName').value.trim();
Â  Â  Â  let natid = document.getElementById('natID').value.trim();

Â  Â  Â  const msg = document.getElementById('add-msg');
Â  Â  Â  msg.textContent = ''; msg.className = 'msg';

Â  Â  Â  if (!userPlace) return;
Â  Â  Â  if (name.length < 2) {
Â  Â  Â  Â  msg.textContent = 'ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨'; msg.className += ' error'; return;
Â  Â  Â  }
Â  Â  Â Â 
Â  Â  Â  // Ù‡Ù†Ø§ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„: Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù‚ÙˆÙ…ÙŠ 14 Ø±Ù‚Ù…
Â  Â  Â  if (!/^\d{14}$/.test(natid)) {
Â  Â  Â  Â  msg.textContent = 'ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ù€ 14 Ø±Ù‚Ù… Ù„Ù„Ø±Ù‚Ù… Ø§Ù„Ù‚ÙˆÙ…ÙŠ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­.'; msg.className += ' error'; return;
Â  Â  Â  }

Â  Â  Â  btn.disabled = true; btn.innerText = 'Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ø¶Ø§ÙØ©...';

Â  Â  Â  try {
Â  Â  Â  Â  const snapshot = await get(child(ref(db), 'users/' + natid));
Â  Â  Â  Â Â 
Â  Â  Â  Â  if (snapshot.exists()) {
Â  Â  Â  Â  Â  // --- ØªÙƒØ±Ø§Ø± ---
Â  Â  Â  Â  Â  let data = snapshot.val();
Â  Â  Â  Â  Â  document.getElementById('errorSound').play().catch(e => console.log('Audio play blocked'));

Â  Â  Â  Â  Â  msg.className = 'duplicate-box';
Â  Â  Â  Â  Â  msg.innerHTML = `
Â  Â  Â  Â  Â  Â  <span>âš ï¸ ØªÙ†Ø¨ÙŠÙ‡ ØªÙƒØ±Ø§Ø±!</span>
Â  Â  Â  Â  Â  Â  <div style="margin-top:5px; font-size:13px; color:#333;">
Â  Â  Â  Â  Â  Â  Â Ø§Ù„ÙƒÙˆØ¯ (${natid}) Ù…Ø³Ø¬Ù„ Ù…Ø³Ø¨Ù‚Ø§Ù‹ ÙÙŠ <br>
Â  Â  Â  Â  Â  Â  Â <b style="color:#d32f2f; font-size:15px;">${data.place}</b> <br>
Â  Â  Â  Â  Â  Â  Â Ø¨ÙˆØ§Ø³Ø·Ø© <b style="color:#d32f2f; font-size:15px;">${data.repName}</b>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  `;

Â  Â  Â  Â  Â  const duplicateData = {
Â  Â  Â  Â  Â  Â  Â  duplicatedID: natid,
Â  Â  Â  Â  Â  Â  Â  attemptByRep: name,
Â  Â  Â  Â  Â  Â  Â  attemptPlace: userPlace,
Â  Â  Â  Â  Â  Â  Â  originalRep: data.repName,
Â  Â  Â  Â  Â  Â  Â  originalPlace: data.place,
Â  Â  Â  Â  Â  Â  Â  timestamp: new Date().toISOString(),
Â  Â  Â  Â  Â  Â  Â  status: "rejected"
Â  Â  Â  Â  Â  };
Â  Â  Â  Â  Â  await push(ref(db, 'duplicates'), duplicateData);
Â  Â  Â  Â  Â  saveRepName(name);

Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  // --- Ø¥Ø¶Ø§ÙØ© Ù†Ø§Ø¬Ø­Ø© ---
Â  Â  Â  Â  Â  const now = new Date();
Â  Â  Â  Â  Â  let payload = {
Â  Â  Â  Â  Â  Â  natid, repName: name, place: userPlace, placeIdx: userPlaceIdx,
Â  Â  Â  Â  Â  Â  time: now.toISOString(), username: userID
Â  Â  Â  Â  Â  };
Â  Â  Â  Â  Â  await set(ref(db, 'users/' + natid), payload);
Â  Â  Â  Â  Â  saveRepName(name);

Â  Â  Â  Â  Â  msg.className += ' success';
Â  Â  Â  Â  Â  msg.textContent = "ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ø¨Ù†Ø¬Ø§Ø­.";
Â  Â  Â  Â  Â  document.getElementById('natID').value = '';
Â  Â  Â  Â  Â  document.getElementById('natID').focus();
Â  Â  Â  Â  }
Â  Â  Â  } catch (error) {
Â  Â  Â  Â  msg.className = 'msg error';
Â  Â  Â  Â  msg.textContent = 'Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ØŒ Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.';
Â  Â  Â  Â  console.error(error);
Â  Â  Â  } finally {
Â  Â  Â  Â  btn.disabled = false;
Â  Â  Â  Â  btn.innerText = originalText;
Â  Â  Â  }
Â  Â  }

Â  Â  // Stats / Admin Logic
Â  Â  window.showStatsLogin = function() {
Â  Â  Â  Â  document.getElementById('main-card').classList.add('hidden');
Â  Â  Â  Â  const statsCard = document.getElementById('stats-auth-card');
Â  Â  Â  Â  statsCard.classList.remove('hidden');
Â  Â  Â  Â  statsCard.classList.add('fade-in');
Â  Â  Â  Â  document.getElementById('statsPass').value = '';
Â  Â  Â  Â  document.getElementById('stats-msg').textContent = '';
Â  Â  Â  Â  document.getElementById('statsPass').focus();
Â  Â  }
Â  Â  window.cancelStats = function() {
Â  Â  Â  Â  document.getElementById('stats-auth-card').classList.add('hidden');
Â  Â  Â  Â  const mainCard = document.getElementById('main-card');
Â  Â  Â  Â  mainCard.classList.remove('hidden');
Â  Â  Â  Â  mainCard.classList.add('fade-in');
Â  Â  }
Â  Â  window.verifyStats = function() {
Â  Â  Â  Â  const pass = document.getElementById('statsPass').value;
Â  Â  Â  Â  const msg = document.getElementById('stats-msg');
Â  Â  Â  Â Â 
Â  Â  Â  Â  if(pass === '251988') {
Â  Â  Â  Â  Â  Â  msg.className = 'msg success';
Â  Â  Â  Â  Â  Â  msg.textContent = 'ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØµØ­ÙŠØ­Ø©.';
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  setTimeout(() => {Â 
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('stats-auth-card').classList.add('hidden');
Â  Â  Â  Â  Â  Â  Â  Â  const adminPanel = document.getElementById('admin-panel-card');
Â  Â  Â  Â  Â  Â  Â  Â  adminPanel.classList.remove('hidden');
Â  Â  Â  Â  Â  Â  Â  Â  adminPanel.classList.add('fade-in');
Â  Â  Â  Â  Â  Â  Â  Â  renderAdminRepList();Â 
Â  Â  Â  Â  Â  Â  }, 500);

Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  msg.className = 'msg error';
Â  Â  Â  Â  Â  Â  msg.textContent = 'ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø®Ø§Ø·Ø¦Ø©!';
Â  Â  Â  Â  }
Â  Â  }
Â  </script>
</body>
</html>
