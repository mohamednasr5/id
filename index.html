<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨ - Ù†Ø¸Ø§Ù… Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ø¬Ù„Ø³Ø§Øª</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;800&display=swap">
  <style>
    :root {
      --primary-color: #0072ff;
      --secondary-color: #00c6ff;
      --bg-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      --glass-bg: rgba(255, 255, 255, 0.98);
      --glass-shadow: 0 30px 80px rgba(0, 0, 0, 0.4);
      --input-bg: #f0f4f8;
      --text-color: #2d3436;
      --error-color: #e74c3c;
      --success-color: #2ecc71;
      --message-color: #9b59b6;
      --warning-color: #f39c12;
      --dark: #2c3e50;
      --light: #ecf0f1;
      --info: #3498db;
    }
    
    * { box-sizing: border-box; outline: none; margin: 0; padding: 0; }
    
    body {
      font-family: "Cairo", sans-serif;
      background: var(--bg-gradient);
      background-size: 400% 400%;
      animation: gradientBG 15s ease infinite;
      overflow: hidden;
      color: var(--text-color);
      position: fixed;
      width: 100%;
      height: 100%;
      top: 0;
      left: 0;
    }
    
    @keyframes gradientBG {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    
    /* Ø­Ù„Ù‚Ø§Øª Ø§Ù„Ø®Ù„ÙÙŠØ© Ø§Ù„Ù…ØªØ­Ø±ÙƒØ© */
    .circles { 
      position: absolute; 
      width: 100%; 
      height: 100%; 
      overflow: hidden; 
      top: 0; 
      left: 0; 
      z-index: 0; 
    }
    
    .circles li { 
      position: absolute; 
      display: block; 
      list-style-type: none; 
      width: 20px; 
      height: 20px; 
      background: rgba(255,255,255,0.2); 
      animation: animate 25s linear infinite; 
      bottom: -150px; 
      border-radius: 50%; 
    }
    
    .circles li:nth-child(1) { left: 25%; width: 80px; height: 80px; animation-delay: 0s; }
    .circles li:nth-child(2) { left: 10%; width: 20px; height: 20px; animation-delay: 2s; animation-duration: 12s; }
    .circles li:nth-child(3) { left: 70%; width: 20px; height: 20px; animation-delay: 4s; }
    .circles li:nth-child(4) { left: 40%; width: 60px; height: 60px; animation-delay: 0s; animation-duration: 18s; }
    .circles li:nth-child(5) { left: 65%; width: 20px; height: 20px; animation-delay: 0s; }
    .circles li:nth-child(6) { left: 85%; width: 40px; height: 40px; animation-delay: 5s; }
    .circles li:nth-child(7) { left: 50%; width: 30px; height: 30px; animation-delay: 10s; }
    
    @keyframes animate {
      0%   { transform: translateY(0) rotate(0); opacity: 1; }
      100% { transform: translateY(-1000px) rotate(720deg); opacity: 0; }
    }
    
    /* Ø§Ù„Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© */
    .container { 
      width: 100%; 
      height: 100vh;
      display: flex; 
      justify-content: center; 
      align-items: center;
      position: relative; 
      z-index: 1; 
      padding: 15px;
    }
    
    /* Ø§Ù„ÙƒØ±ÙˆØª */
    .card {
      background: var(--glass-bg);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border-radius: 25px;
      padding: 30px 25px;
      width: 100%;
      max-width: 450px;
      max-height: calc(100vh - 30px);
      box-shadow: var(--glass-shadow);
      border: 1px solid rgba(255,255,255,0.25);
      transform: translateY(20px);
      opacity: 0;
      animation: fadeInUp 0.8s forwards;
      transition: all 0.4s ease;
      overflow-y: auto;
      overflow-x: hidden;
      display: flex;
      flex-direction: column;
    }
    
    @keyframes fadeInUp { 
      to { 
        transform: translateY(0); 
        opacity: 1; 
      } 
    }
    
    /* Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ…Ø±ÙŠØ± */
    .card::-webkit-scrollbar {
      width: 8px;
    }
    
    .card::-webkit-scrollbar-track {
      background: rgba(0, 0, 0, 0.05);
      border-radius: 10px;
    }
    
    .card::-webkit-scrollbar-thumb {
      background: var(--primary-color);
      border-radius: 10px;
    }
    
    .card::-webkit-scrollbar-thumb:hover {
      background: var(--secondary-color);
    }
    
    /* Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø¹Ø§Ù…Ø© */
    .hidden { display: none !important; }
    
    .fade-in { 
      animation: fadeIn 0.4s forwards; 
    }
    
    @keyframes fadeIn {
      from { 
        opacity: 0; 
        transform: translateY(10px); 
      }
      to { 
        opacity: 1; 
        transform: translateY(0); 
      }
    }
    
    h2 { 
      text-align: center; 
      margin-bottom: 20px; 
      color: var(--primary-color); 
      font-size: 24px; 
      font-weight: 800; 
      text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
    }
    
    h3 { 
      font-size: 16px; 
      margin: 15px 0 8px; 
      padding-bottom: 6px; 
      border-bottom: 2px solid #eee; 
      color: var(--dark);
      font-weight: 700;
    }
    
    /* Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ */
    .input-group { 
      position: relative; 
      margin-bottom: 20px; 
    }
    
    input {
      width: 100%; 
      padding: 15px 20px; 
      background: var(--input-bg);
      border: 2px solid transparent; 
      border-radius: 15px; 
      font-size: 16px; 
      transition: all 0.3s ease;
      font-family: "Cairo", sans-serif;
      color: var(--dark);
    }
    
    input:focus {
      background: #fff; 
      border-color: var(--primary-color);
      box-shadow: 0 0 20px rgba(0,114,255,0.2);
      transform: translateY(-2px);
    }
    
    .input-group label {
      position: absolute; 
      right: 20px; 
      top: 50%; 
      transform: translateY(-50%);
      color: #999; 
      transition: all 0.3s ease; 
      pointer-events: none; 
      font-size: 15px;
      opacity: 1;
      background: transparent;
      padding: 0 5px;
    }
    
    input:focus + label,
    input:not(:placeholder-shown) + label {
      opacity: 0;
      transform: translateY(-50%) scale(0.9);
    }
    
    /* Ø®ÙŠØ§Ø± ØªØ°ÙƒØ±Ù†ÙŠ */
    .remember-me {
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 15px 0;
      color: #666;
      font-size: 14px;
    }
    
    .remember-me input {
      width: 18px;
      height: 18px;
      margin-left: 8px;
      cursor: pointer;
    }
    
    /* Ø´Ø±ÙŠØ· Ø§Ù„Ø¨Ø­Ø« */
    .search-container {
      position: relative;
      margin-bottom: 15px;
    }
    
    .search-box {
      width: 100%;
      padding: 15px 20px;
      border: none;
      border-radius: 50px;
      font-family: 'Cairo', sans-serif;
      font-size: 15px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
      transition: all 0.3s ease;
      background: white;
    }
    
    .search-box:focus {
      outline: none;
      box-shadow: 0 6px 25px rgba(0,0,0,0.15);
      transform: translateY(-2px);
    }
    
    .search-icon {
      position: absolute;
      left: 20px;
      top: 50%;
      transform: translateY(-50%);
      color: #999;
      font-size: 18px;
    }
    
    /* Ø²Ø± Ø§Ù„Ø¨Ø­Ø« Ø§Ù„ØµÙˆØªÙŠ */
    .voice-search-btn {
      position: absolute;
      left: 60px;
      top: 50%;
      transform: translateY(-50%);
      background: var(--info);
      color: white;
      border: none;
      border-radius: 50%;
      width: 35px;
      height: 35px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 16px;
      transition: all 0.3s ease;
      box-shadow: 0 4px 10px rgba(52, 152, 219, 0.3);
      z-index: 2;
    }
    
    .voice-search-btn:hover {
      background: #2980b9;
      transform: translateY(-50%) scale(1.1);
    }
    
    .voice-search-btn.listening {
      background: var(--error-color);
      animation: pulse 1s infinite;
    }
    
    @keyframes pulse {
      0%, 100% { transform: translateY(-50%) scale(1); }
      50% { transform: translateY(-50%) scale(1.1); }
    }
    
    .voice-status {
      position: absolute;
      left: 105px;
      top: 50%;
      transform: translateY(-50%);
      color: white;
      font-size: 12px;
      background: rgba(0,0,0,0.5);
      padding: 4px 8px;
      border-radius: 10px;
      display: none;
      z-index: 2;
    }
    
    /* ØµÙˆØ±Ø© Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© */
    .id-card-visual-container { 
      text-align: center; 
      margin: 15px 0; 
    }
    
    .id-card-img { 
      max-width: 70%; 
      border-radius: 15px; 
      border: 3px solid rgba(255,255,255,0.8); 
      box-shadow: 0 12px 30px rgba(0,114,255,0.3); 
      animation: floatCard 4s ease-in-out infinite; 
      transition: all 0.3s ease;
    }
    
    .id-card-img:hover {
      transform: scale(1.02);
      box-shadow: 0 15px 40px rgba(0,114,255,0.4);
    }
    
    @keyframes floatCard { 
      0%,100% { transform: translateY(0); } 
      50% { transform: translateY(-8px); } 
    }
    
    /* Ø§Ù„Ø£Ø²Ø±Ø§Ø± */
    .btn {
      background: linear-gradient(135deg, var(--secondary-color), var(--primary-color));
      color: #fff; 
      padding: 15px; 
      width: 100%; 
      border: none; 
      border-radius: 50px;
      font-weight: 700; 
      cursor: pointer; 
      font-size: 16px; 
      transition: all 0.3s ease;
      box-shadow: 0 10px 25px rgba(0,114,255,0.3);
      font-family: "Cairo", sans-serif;
      position: relative;
      overflow: hidden;
    }
    
    .btn::after {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
      transition: 0.5s;
    }
    
    .btn:hover::after {
      left: 100%;
    }
    
    .btn:hover { 
      transform: translateY(-3px); 
      box-shadow: 0 15px 35px rgba(0,114,255,0.4);
    }
    
    .btn:active { 
      transform: translateY(1px); 
    }
    
    .btn-secondary { 
      background: linear-gradient(135deg, #43cea2, #185a9d); 
      margin-top: 10px; 
    }
    
    .btn-danger { 
      background: linear-gradient(135deg, #ff416c, #ff4b2b); 
      margin-top: 10px; 
    }
    
    .btn-warning { 
      background: linear-gradient(135deg, #f2994a, #f2c94c); 
      color: #333; 
    }
    
    .btn-info { 
      background: linear-gradient(135deg, #3498db, #2980b9); 
      margin-top: 10px; 
    }
    
    .btn-message { 
      background: linear-gradient(135deg, #9b59b6, #8e44ad); 
      margin-top: 10px; 
      position: relative; 
    }
    
    .btn-delete-rep { 
      background: #ff4757; 
      color: white; 
      border: none; 
      padding: 5px 12px; 
      border-radius: 8px; 
      cursor: pointer; 
      font-size: 12px; 
      font-family: "Cairo", sans-serif;
      transition: all 0.3s ease;
    }
    
    .btn-delete-rep:hover {
      background: #ff3742;
      transform: scale(1.05);
    }
    
    /* Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ */
    .msg { 
      text-align: center; 
      font-size: 14px; 
      margin-top: 10px; 
      min-height: 20px; 
      padding: 8px;
      border-radius: 10px;
    }
    
    .msg.error { 
      color: var(--error-color); 
      background: rgba(231, 76, 60, 0.1);
      border: 1px solid rgba(231, 76, 60, 0.2);
    }
    
    .msg.success { 
      color: var(--success-color); 
      background: rgba(46, 204, 113, 0.1);
      border: 1px solid rgba(46, 204, 113, 0.2);
    }
    
    /* ØªØ­Ø°ÙŠØ±Ø§Øª Ø§Ù„ØªÙƒØ±Ø§Ø± */
    .duplicate-box {
      background: linear-gradient(135deg, #ffebee 0%, #ef9a9a 100%);
      border: 3px solid var(--error-color);
      padding: 15px;
      text-align: center;
      border-radius: 15px;
      animation: pulseRed 0.7s infinite alternate;
      font-size: 14px;
      font-weight: 600;
      margin: 10px 0;
    }
    
    @keyframes pulseRed { 
      from { box-shadow: 0 0 10px rgba(255,0,0,0.3); } 
      to { box-shadow: 0 0 20px rgba(255,0,0,0.6); } 
    }
    
    .verify-box {
      background: linear-gradient(135deg, #e0f7fa 0%, #80deea 100%);
      border: 3px solid var(--success-color);
      padding: 20px;
      text-align: center;
      border-radius: 15px;
      animation: pulseGreen 0.7s infinite alternate;
      font-size: 16px;
      font-weight: 700;
      color: var(--success-color);
      margin: 10px 0;
    }
    
    @keyframes pulseGreen { 
      from { box-shadow: 0 0 10px rgba(46,204,113,0.3); } 
      to { box-shadow: 0 0 20px rgba(46,204,113,0.6); } 
    }
    
    /* Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… */
    .admin-list-container { 
      max-height: 150px; 
      overflow-y: auto; 
      background: rgba(255,255,255,0.8); 
      padding: 10px; 
      border-radius: 12px; 
      font-size: 14px;
      border: 1px solid rgba(0,0,0,0.1);
    }
    
    .admin-list-container::-webkit-scrollbar {
      width: 6px;
    }
    
    .admin-list-container::-webkit-scrollbar-thumb {
      background: var(--primary-color);
      border-radius: 5px;
    }
    
    .rep-item { 
      display: flex; 
      justify-content: space-between; 
      padding: 8px; 
      align-items: center; 
      font-size: 14px; 
      background: white;
      margin-bottom: 5px;
      border-radius: 8px;
      border-right: 3px solid var(--primary-color);
      transition: all 0.3s ease;
    }
    
    .rep-item:hover {
      background: #f8f9fa;
      transform: translateX(-5px);
    }
    
    .rep-name { 
      font-weight: 700; 
      color: var(--dark);
    }
    
    .session-item { 
      background: #fff; 
      border-right: 4px solid var(--primary-color); 
      padding: 8px; 
      margin-bottom: 6px; 
      border-radius: 8px; 
      font-size: 13px; 
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    
    .session-kick-btn { 
      background: var(--dark); 
      color: #fff; 
      padding: 4px 10px; 
      border-radius: 6px; 
      border: none; 
      cursor: pointer; 
      font-family: "Cairo", sans-serif; 
      font-size: 12px; 
      transition: all 0.3s ease;
    }
    
    .session-kick-btn:hover {
      background: var(--error-color);
      transform: scale(1.05);
    }
    
    /* Ø§Ù„Ø¹Ø¯Ø§Ø¯Ø§Øª */
    .counter-box { 
      background: linear-gradient(135deg, #f0f7ff 0%, #d6e4ff 100%);
      color: var(--primary-color); 
      padding: 15px; 
      font-size: 16px; 
      border-radius: 15px; 
      margin-bottom: 15px; 
      text-align: center; 
      border: 2px solid rgba(0,114,255,0.2);
      font-weight: 600;
    }
    
    .counter-label { 
      font-size: 12px; 
      color: #666; 
      margin-top: 5px; 
      font-weight: 400;
    }
    
    .empty-list { 
      text-align: center; 
      padding: 20px; 
      color: #999; 
      font-size: 14px; 
      font-style: italic;
    }
    
    .device-info { 
      font-size: 11px; 
      color: #666; 
      margin: 0 5px; 
    }
    
    /* Ø±ÙˆØ§Ø¨Ø· ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ */
    .logout-link {
      margin-top: 15px;
      text-align: center;
      font-size: 14px;
    }
    
    .logout-link small {
      cursor: pointer;
      color: #777;
      text-decoration: underline;
      transition: all 0.3s ease;
      padding: 5px 10px;
      border-radius: 8px;
    }
    
    .logout-link small:hover {
      color: var(--primary-color);
      background: rgba(0, 114, 255, 0.1);
    }
    
    /* ÙˆØµÙ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª */
    .stats-desc {
      text-align: center;
      color: #666;
      margin-bottom: 20px;
      font-size: 14px;
      line-height: 1.5;
    }
    
    /* Ø¹Ù†Ø§ØµØ± Ø§Ù„ØªØ­ÙƒÙ… */
    .admin-controls {
      display: flex;
      justify-content: center;
      gap: 8px;
      margin: 12px 0;
      flex-wrap: wrap;
    }
    
    .admin-controls .btn {
      width: auto;
      padding: 8px 16px;
      font-size: 14px;
      min-width: 100px;
    }
    
    .sessions-note {
      font-size: 12px;
      color: #666;
      text-align: right;
      margin-top: 5px;
      margin-bottom: 8px;
      font-style: italic;
    }
    
    /* Ø´Ø§Ø±Ø© Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ */
    .messages-badge {
      position: absolute;
      top: -8px;
      left: -8px;
      background: #e74c3c;
      color: white;
      width: 24px;
      height: 24px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      font-weight: 800;
      animation: badgePulse 1.5s infinite;
      box-shadow: 0 2px 10px rgba(231, 76, 60, 0.5);
      z-index: 1;
    }
    
    @keyframes badgePulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.15); }
    }
    
    /* Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø© */
    .general-notification {
      background: linear-gradient(135deg, #f5f3ff 0%, #e8e0ff 100%);
      border: 3px solid var(--message-color);
      border-radius: 15px;
      padding: 15px;
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      gap: 12px;
      box-shadow: 0 6px 20px rgba(155, 89, 182, 0.3);
      animation: notificationSlideDown 0.5s ease;
      position: relative;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .general-notification:hover {
      transform: translateY(-3px);
      box-shadow: 0 10px 30px rgba(155, 89, 182, 0.4);
    }
    
    .general-notification.unread {
      border-color: #e74c3c;
      background: linear-gradient(135deg, #fff5f5 0%, #ffe0e0 100%);
      animation: notificationGlow 2s infinite;
    }
    
    @keyframes notificationSlideDown {
      from {
        opacity: 0;
        transform: translateY(-20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    @keyframes notificationGlow {
      0%, 100% {
        box-shadow: 0 6px 20px rgba(231, 76, 60, 0.3);
      }
      50% {
        box-shadow: 0 8px 25px rgba(231, 76, 60, 0.6);
      }
    }
    
    .notification-icon {
      font-size: 32px;
      flex-shrink: 0;
    }
    
    .notification-content {
      flex: 1;
      min-width: 0;
    }
    
    .notification-text {
      color: var(--text-color);
      font-size: 14px;
      font-weight: 700;
      margin-bottom: 4px;
      line-height: 1.4;
    }
    
    .notification-count {
      font-size: 12px;
      color: #666;
    }
    
    .notification-close {
      background: transparent;
      border: none;
      color: #999;
      font-size: 22px;
      cursor: pointer;
      padding: 0;
      width: 28px;
      height: 28px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      transition: all 0.3s ease;
      flex-shrink: 0;
    }
    
    .notification-close:hover {
      background: rgba(0, 0, 0, 0.1);
      color: var(--error-color);
      transform: rotate(90deg);
    }
    
    /* Ù†Ø§ÙØ°Ø© Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ */
    .messages-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.85);
      z-index: 10000;
      display: none;
      align-items: center;
      justify-content: center;
      padding: 20px;
      backdrop-filter: blur(10px);
    }
    
    .messages-modal.active {
      display: flex;
    }
    
    .messages-modal-content {
      background: white;
      border-radius: 25px;
      padding: 30px;
      max-width: 550px;
      width: 100%;
      max-height: 85vh;
      overflow-y: auto;
      animation: modalSlideIn 0.4s ease;
      box-shadow: 0 30px 80px rgba(0,0,0,0.5);
    }
    
    @keyframes modalSlideIn {
      from {
        opacity: 0;
        transform: scale(0.9) translateY(-30px);
      }
      to {
        opacity: 1;
        transform: scale(1) translateY(0);
      }
    }
    
    .messages-modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 25px;
      padding-bottom: 15px;
      border-bottom: 3px solid #eee;
    }
    
    .messages-modal-title {
      margin: 0;
      color: var(--primary-color);
      font-size: 22px;
      font-weight: 800;
    }
    
    .modal-close-btn {
      background: var(--error-color);
      color: white;
      border: none;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      font-size: 22px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
      box-shadow: 0 4px 12px rgba(231, 76, 60, 0.3);
    }
    
    .modal-close-btn:hover {
      transform: rotate(90deg);
      background: #c0392b;
    }
    
    /* Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ */
    .message-card {
      background: linear-gradient(135deg, #f5f3ff 0%, #e8e0ff 100%);
      border: 3px solid var(--message-color);
      border-radius: 20px;
      padding: 20px;
      margin-bottom: 15px;
      box-shadow: 0 6px 20px rgba(155, 89, 182, 0.25);
      animation: messageSlideIn 0.5s ease;
      transition: all 0.3s ease;
    }
    
    .message-card.unread {
      border-color: #e74c3c;
      background: linear-gradient(135deg, #fff5f5 0%, #ffe0e0 100%);
    }
    
    @keyframes messageSlideIn {
      from {
        opacity: 0;
        transform: translateX(30px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }
    
    .message-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 12px 30px rgba(155, 89, 182, 0.4);
    }
    
    .message-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
      padding-bottom: 10px;
      border-bottom: 2px solid rgba(155, 89, 182, 0.2);
    }
    
    .message-icon {
      font-size: 24px;
    }
    
    .message-time {
      font-size: 12px;
      color: #666;
      font-weight: 600;
    }
    
    .message-text {
      color: var(--text-color);
      font-size: 15px;
      line-height: 1.7;
      margin-bottom: 12px;
      font-weight: 600;
    }
    
    .message-from {
      font-size: 12px;
      color: var(--message-color);
      font-weight: 700;
      text-align: left;
    }
    
    .message-actions {
      display: flex;
      gap: 10px;
      margin-top: 12px;
    }
    
    .message-btn {
      flex: 1;
      padding: 10px;
      border: none;
      border-radius: 12px;
      font-family: "Cairo", sans-serif;
      font-size: 13px;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .mark-read-btn {
      background: var(--success-color);
      color: white;
      box-shadow: 0 4px 12px rgba(46, 204, 113, 0.3);
    }
    
    .mark-read-btn:hover {
      background: #27ae60;
      transform: translateY(-2px);
      box-shadow: 0 6px 18px rgba(46, 204, 113, 0.4);
    }
    
    .no-messages {
      text-align: center;
      padding: 40px 30px;
      color: #999;
      font-size: 15px;
      background: rgba(0, 0, 0, 0.02);
      border-radius: 15px;
      border: 2px dashed #ddd;
    }
    
    .no-messages-icon {
      font-size: 60px;
      margin-bottom: 15px;
      opacity: 0.3;
    }
    
    /* Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© */
    .popup-notification {
      position: fixed;
      top: 25px;
      right: 25px;
      background: linear-gradient(135deg, #9b59b6, #8e44ad);
      color: white;
      padding: 20px 25px;
      border-radius: 20px;
      box-shadow: 0 15px 40px rgba(155, 89, 182, 0.6);
      z-index: 10001;
      animation: popupSlide 0.5s ease;
      max-width: 350px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 15px;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255,255,255,0.2);
    }
    
    @keyframes popupSlide {
      from {
        transform: translateX(400px);
        opacity: 0;
      }
      to {
        transform: translateX(0);
        opacity: 1;
      }
    }
    
    .popup-icon {
      font-size: 40px;
      flex-shrink: 0;
    }
    
    .popup-content {
      flex: 1;
    }
    
    .popup-header {
      font-weight: 800;
      font-size: 16px;
      margin-bottom: 6px;
    }
    
    .popup-text {
      font-size: 14px;
      line-height: 1.5;
      opacity: 0.95;
    }
    
    /* Ø§Ù„ØªÙƒÙŠÙ Ù…Ø¹ Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© */
    @media (max-height: 700px) {
      .card { padding: 20px; }
      h2 { font-size: 20px; margin-bottom: 15px; }
      .input-group { margin-bottom: 15px; }
      input { padding: 12px 18px; font-size: 15px; }
      .btn { padding: 12px; font-size: 15px; }
      .id-card-img { max-width: 60%; }
      .counter-box { padding: 12px; font-size: 15px; }
      h3 { font-size: 15px; }
      .general-notification { padding: 12px; }
      .notification-text { font-size: 13px; }
    }
    
    @media (max-width: 480px) {
      .container { padding: 10px; }
      .card { max-width: 100%; padding: 20px; border-radius: 20px; }
      .popup-notification {
        right: 15px;
        left: 15px;
        max-width: none;
        top: 15px;
      }
      .messages-modal-content {
        padding: 20px;
      }
      .voice-search-btn {
        left: 50px;
        width: 30px;
        height: 30px;
        font-size: 14px;
      }
      .voice-status {
        left: 90px;
        font-size: 11px;
      }
    }
  </style>
</head>
<body>
  <!-- Ø§Ù„Ø£ØµÙˆØ§Øª -->
  <audio id="duplicateAlarm1" preload="auto">
    <source src="https://actions.google.com/sounds/v1/alarms/alarm_clock.ogg" type="audio/ogg">
  </audio>
  <audio id="duplicateAlarm2" preload="auto">
    <source src="https://actions.google.com/sounds/v1/alarms/beep_short.ogg" type="audio/ogg">
  </audio>
  <audio id="duplicateAlarm3" preload="auto">
    <source src="https://actions.google.com/sounds/v1/emergency/siren_1.ogg" type="audio/ogg">
  </audio>
  <audio id="messageSound" src="https://actions.google.com/sounds/v1/notifications/notification_simple.ogg" preload="auto"></audio>

  <!-- Ø­Ù„Ù‚Ø§Øª Ø§Ù„Ø®Ù„ÙÙŠØ© -->
  <ul class="circles">
    <li></li><li></li><li></li><li></li><li></li><li></li><li></li>
  </ul>

  <!-- Ø§Ù„Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© -->
  <div class="container">
    
    <!-- ØµÙØ­Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© -->
    <div class="card" id="auth-card">
      <h2>ğŸ” ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨</h2>
      <div class="search-container">
        <input 
          type="tel" 
          id="loginCode" 
          class="search-box" 
          inputmode="numeric" 
          placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙˆØ¯ Ø§Ù„Ø¯Ø®ÙˆÙ„ (6 Ø£Ø±Ù‚Ø§Ù…)"
          onkeypress="if(event.key==='Enter') login()"
        >
        <span class="search-icon">ğŸ”¢</span>
        <button class="voice-search-btn" id="voiceSearchBtn" onclick="toggleVoiceSearch()" title="Ø¥Ø¯Ø®Ø§Ù„ ØµÙˆØªÙŠ">
          ğŸ¤
        </button>
        <div class="voice-status" id="voiceStatus"></div>
      </div>
      
      <div class="remember-me">
        <input type="checkbox" id="rememberLogin">
        <label for="rememberLogin">ØªØ°ÙƒØ±Ù†ÙŠ Ø¹Ù„Ù‰ Ù‡Ø°Ø§ Ø§Ù„Ø¬Ù‡Ø§Ø²</label>
      </div>
      
      <button class="btn" id="loginBtn" onclick="login()">
        Ø¯Ø®ÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ù†Ø¸Ø§Ù…
      </button>
      <div id="login-msg" class="msg"></div>
      
      <div class="logout-link">
        <small onclick="showAbout()">â„¹ï¸ Ø¹Ù† Ø§Ù„Ù†Ø¸Ø§Ù…</small>
      </div>
    </div>
    
    <!-- ØµÙØ­Ø© Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© -->
    <div class="card hidden" id="verification-card">
      <h2>ğŸ” Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©</h2>
      <p class="stats-desc">
        Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© ÙÙ‚Ø· - Ù„Ø§ ÙŠØªÙ… Ø§Ù„ØªØ³Ø¬ÙŠÙ„ ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù…
      </p>
      
      <div class="input-group">
        <input id="verifyNatID" type="tel" maxlength="14" inputmode="numeric" placeholder=" ">
        <label for="verifyNatID">Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù‚ÙˆÙ…ÙŠ (14 Ø±Ù‚Ù…)</label>
      </div>
      
      <div class="id-card-visual-container">
        <img src="https://raw.githubusercontent.com/mohamednasr5/id/e83438329b0f009f6eebf61b2797496d744589f2/5.png"
             class="id-card-img" alt="Ù…Ø«Ø§Ù„ Ù„Ù„Ø¨Ø·Ø§Ù‚Ø©">
      </div>
      
      <button class="btn" onclick="checkCard()">âœ“ ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©</button>
      <div id="verify-msg" class="msg"></div>
      
      <button class="btn btn-secondary" onclick="logout()">
        â†© Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
      </button>
    </div>
    
    <!-- ØµÙØ­Ø© Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© -->
    <div class="card hidden" id="main-card">
      <h2 id="welcome">Ù…Ø±Ø­Ø¨Ù‹Ø§ ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù…</h2>
      
      <!-- Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø© -->
      <div id="generalNotification"></div>
      
      <!-- Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„Ø§Øª -->
      <div class="counter-box" id="entryCounterBox">
        Ø¹Ø¯Ø¯ Ø¥Ø¯Ø®Ø§Ù„Ø§ØªÙƒ Ø§Ù„ÙŠÙˆÙ…: <span id="entryCounter">0</span>
        <div class="counter-label">
          Ø­Ø§ÙØ¸ Ø¹Ù„Ù‰ Ù†ÙØ³ Ø§Ø³Ù… Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨ Ù„ØµØ­Ø© Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
        </div>
      </div>
      
      <!-- Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª -->
      <div class="input-group">
        <input id="repName" type="text" autocomplete="off" list="repNamesHistory" maxlength="30" placeholder=" ">
        <datalist id="repNamesHistory"></datalist>
        <label for="repName">Ø§Ø³Ù… Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨ (Ø§Ø³Ù…Ùƒ Ø£Ù†Øª)</label>
      </div>
      
      <div class="input-group">
        <input id="natID" type="tel" maxlength="14" inputmode="numeric" placeholder=" ">
        <label for="natID">Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù‚ÙˆÙ…ÙŠ (14 Ø±Ù‚Ù…)</label>
      </div>
      
      <div class="id-card-visual-container">
        <img src="https://raw.githubusercontent.com/mohamednasr5/id/e83438329b0f009f6eebf61b2797496d744589f2/5.png"
             class="id-card-img" alt="Ù…Ø«Ø§Ù„ Ù„Ù„Ø¨Ø·Ø§Ù‚Ø©">
      </div>
      
      <button class="btn" onclick="addUser()">
        â• Ø¥Ø¶Ø§ÙØ© Ø¨Ø·Ø§Ù‚Ø© Ø¬Ø¯ÙŠØ¯Ø©
      </button>
      <div id="add-msg" class="msg"></div>
      
      <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… -->
      <button class="btn btn-message" onclick="showMessagesModal()" style="position: relative;">
        <span id="messagesBtnText">ğŸ“¨ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„</span>
        <span class="messages-badge hidden" id="messagesBadge">0</span>
      </button>
      
      <button class="btn btn-secondary" onclick="showStatsLogin()">
        ğŸ“Š Ù„ÙˆØ­Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù†Ø¸Ø§Ù…
      </button>
      
      <div class="logout-link">
        <small onclick="logout()">ğŸ‘‹ ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬</small>
      </div>
    </div>
    
    <!-- ØµÙØ­Ø© ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„Ù…Ø¯ÙŠØ± -->
    <div class="card hidden" id="stats-auth-card">
      <h2>ğŸ”’ ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„Ù…Ø¯ÙŠØ±</h2>
      <p class="stats-desc">Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</p>
      
      <div class="input-group">
        <input id="statsPass" type="password" placeholder=" ">
        <label for="statsPass">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
      </div>
      
      <button class="btn" onclick="verifyStats()">Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù„ÙˆØ­Ø©</button>
      <div id="stats-msg" class="msg"></div>
      
      <button class="btn btn-danger" onclick="cancelStats()">
        â†© Ø¥Ù„ØºØ§Ø¡ ÙˆØ§Ù„Ø¹ÙˆØ¯Ø©
      </button>
    </div>
    
    <!-- Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠØ© -->
    <div class="card hidden" id="admin-panel-card">
      <h2>âš™ï¸ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠØ©</h2>
      
      <button class="btn btn-warning" onclick="location.href='stats.html'">
        ğŸ“Š Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„ØµÙØ­Ø© Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ÙƒØ§Ù…Ù„Ø©
      </button>
      
      <h3>ğŸ“¨ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø±Ø³Ø§Ø¦Ù„</h3>
      <div class="admin-controls">
        <button class="btn btn-info" onclick="viewAllMessages()">Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„</button>
        <button class="btn btn-danger" onclick="deleteAllMessages()">ğŸ—‘ï¸ Ù…Ø³Ø­ ÙƒÙ„ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„</button>
      </div>
      <div class="admin-list-container" id="adminMessagesList"></div>
      
      <h3>Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„Ø§Øª Ø§Ù„ÙŠÙˆÙ…ÙŠ</h3>
      <div class="counter-box">
        <span>Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„Ø­Ø§Ù„ÙŠ: <span id="adminEntryCounter">0</span></span>
        <div class="admin-controls">
          <button class="btn btn-secondary" onclick="adminIncCounter()">â• Ø²ÙŠØ§Ø¯Ø©</button>
          <button class="btn btn-secondary" onclick="adminDecCounter()">â– Ù†Ù‚ØµØ§Ù†</button>
          <button class="btn btn-danger" onclick="adminResetCounter()">ğŸ”„ ØªØµÙÙŠØ±</button>
        </div>
      </div>
      
      <h3>ğŸ‘¥ Ø§Ù„Ø¬Ù„Ø³Ø§Øª Ø§Ù„Ù†Ø´Ø·Ø© Ø§Ù„Ø¢Ù†</h3>
      <p class="sessions-note">Ø§Ù„Ù…Ø³Ù…ÙˆØ­: 3 Ø£Ø¬Ù‡Ø²Ø© Ù„ÙƒÙ„ ÙƒÙˆØ¯ Ø¯Ø®ÙˆÙ„</p>
      <div class="admin-list-container" id="activeSessionsList"></div>
      
      <h3>ğŸ“ Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ù…Ù†Ø§Ø¯ÙŠØ¨ Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©</h3>
      <div class="admin-list-container" id="adminRepList"></div>
      
      <button class="btn btn-danger" onclick="closeAdminPanel()">
        â†© Ø®Ø±ÙˆØ¬ Ù…Ù† Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
      </button>
    </div>
  </div>

  <!-- Ù†Ø§ÙØ°Ø© Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ -->
  <div class="messages-modal" id="messagesModal">
    <div class="messages-modal-content">
      <div class="messages-modal-header">
        <h2 class="messages-modal-title">ğŸ“¨ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„</h2>
        <button class="modal-close-btn" onclick="closeMessagesModal()">Ã—</button>
      </div>
      <div id="messagesModalContent"></div>
    </div>
  </div>

  <!-- JavaScript -->
  <script>
    // Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ù…Ø§ÙƒÙ† Ø§Ù„Ù…Ø­Ø¯Ø«Ø© (69 Ù…ÙƒØ§Ù† - Ù…Ø·Ø§Ø¨Ù‚Ø© Ù„ØµÙØ­Ø© Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª)
    const places = [
      "1- Ø­ÙŠ Ø§Ù„Ø­Ù…Ø²Ø§ÙˆÙŠ - Ø­Ù…Ø§Ø¯Ù‡ Ø¹Ø¨Ø¯Ù‡ Ù…ØµØ¨Ø§Ø­",
      "2- Ø­ÙŠ Ø§Ù„Ø¬Ø±Ù† 3 - Ø¨Ø¬ÙˆØ§Ø± Ù‚Ù‡ÙˆØ© Ø§Ù„Ù†Ø¬Ø¯ÙŠ",
      "3- Ø­ÙŠ Ø§Ù„Ø¬Ø±Ù† 1 - Ø´Ø§Ø±Ø¹ Ø§Ù„Ù…Ø¸Ù„ÙˆÙ…",
      "4- Ø­ÙŠ Ø§Ù„Ø¬Ø±Ù† 2 - Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ… ÙÙ‡ÙŠØ¯",
      "5- Ø­ÙŠ Ø£Ø¨Ùˆ Ø±Ø´Ø§Ø¯ - Ù…Ù‚Ù‡Ù‰ Ø£Ø¨Ùˆ Ø³Ù„ÙŠÙ…Ø§Ù†",
      "6- Ø­ÙŠ Ø§Ù„Ø¥Ø¹Ø¬Ø§Ù… - Ø­Ù…Ø§Ø¯Ø© Ø£Ø¨Ùˆ Ø±Ø´Ø§Ø¯",
      "7- Ø­ÙŠ Ø§Ù„Ø¹Ø²Ø¨Ø© - Ù…Ù†Ø´ÙŠØ© Ù†Ø§ØµØ±",
      "8- Ø­ÙŠ Ø§Ù„Ù…Ø³ØªØ´ÙÙ‰ Ø§Ù„Ø¹Ø§Ù… - Ø­Ù…Ø§Ø¯Ù‡ Ø¹Ø³Ø§Ø³Ù‡",
      "9- Ø­ÙŠ Ø§Ù„Ù…Ù†Ø²Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© - ÙƒØ±ÙŠÙ… Ø´Ù‚Ø±Ù",
      "10- Ø­ÙŠ Ø§Ù„Ù…Ù†Ø²Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© 2 - Ø´Ø±ÙŠÙ Ø¯Ø¨Ø±ÙŠØ§Ø´",
      "11- Ø­ÙŠ Ø¨Ø­Ø± Ø§Ù„Ø¨Ù„Ø¯ 3 - Ø£Ø®Ø± Ø´Ø§Ø±Ø¹ 10",
      "12- Ø­ÙŠ Ø¨Ø­Ø± Ø§Ù„Ø¨Ù„Ø¯ 1 - Ø´Ø§Ø±Ø¹ Ø§Ù„ÙƒØ§Ø¨ØªÙ†",
      "13- Ø­ÙŠ Ø§Ù„ÙÙ‚Ø§Ø¹ÙŠ - Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ… ØºØ²Ù„",
      "14- Ø­ÙŠ Ø§Ù„Ø³Ù„Ù…ÙˆÙ†ÙŠ - Ø­Ø³Ù† Ø§Ù„Ù…Ù†Ø§Ø®Ù„ÙŠ",
      "15- Ø­ÙŠ Ø§Ù„ÙƒÙØ± 1 - Ø§Ù„Ø³Ø§Ø­Ø©",
      "16- Ø­ÙŠ Ø§Ù„ÙƒÙØ± 3 - Ù…Ù„Ø¹Ø¨ Ø¨Ø±Ø´Ù„ÙˆÙ†Ø©",
      "17- Ø­ÙŠ Ø§Ù„ÙƒÙØ± 2 - ØªØ­Øª Ø§Ù„Ø³ÙƒØ©",
      "18- Ø­ÙŠ Ø§Ù„ÙØ¯Ø§Ø¡ 1 - Ø­Ù…Ø§Ø¯Ø© Ø§Ù„ÙƒÙŠØ§Ù„",
      "19- Ø­ÙŠ Ø³ÙˆÙ‚ Ø§Ù„Ø¬Ù…Ù„Ø© - Ø¹Ù„Ù‰ Ø§Ù„Ø¨ÙŠØ§Ø¹",
      "20- Ø­ÙŠ Ù†Ù‚Ø·Ø© Ø§Ù„Ø£Ù…Ø§Ù… Ø¹Ù„Ù‰",
      "21- Ø­ÙŠ Ø§Ù„Ø¨Ø± Ø§Ù„ØªØ§Ù†ÙŠ - Ø­ÙŠ Ø§Ù„Ø³Ù„Ø§Ù…",
      "22- Ø­ÙŠ Ø§Ù„Ø¨Ø± Ø§Ù„ØªØ§Ù†ÙŠ - Ø§Ù„Ù‡Ø§ÙˆÙŠØ³",
      "23- Ø­ÙŠ Ù…ØµÙ†Ø¹ Ø§Ù„Ø¨ØµÙ„ - ÙˆÙ„ÙŠØ¯ ÙÙ‡ÙŠØ¯",
      "24- Ø­ÙŠ Ù…Ø¯Ø±Ø³Ø© Ø¹Ø¨Ø¯ Ø§Ù„Ø¹Ø§Ù„ Ø´Ù„Ø¨Ø§ÙŠØ©",
      "25- Ø­ÙŠ Ø§Ù„Ù…Ø²Ø±Ø¹Ø© - Ø§Ù„Ø³ÙŠØ¯ Ø§Ù„Ø­Ø¯ÙŠØ¯ÙŠ",
      "26- Ø­ÙŠ Ø£Ù…Ù† Ø§Ù„Ø¯ÙˆÙ„Ø©",
      "27- Ù‚Ø±ÙŠØ© Ø§Ù„ÙØ±ÙˆØ³Ø§Øª",
      "28- Ù‚Ø±ÙŠØ© Ø£Ø¨Ùˆ Ø§Ù„Ø£Ø®Ø¶Ø±",
      "29- Ù‚Ø±ÙŠØ© Ø¬Ø¯ÙŠØ¯Ø© Ø§Ù„Ù…Ù†Ø²Ù„Ø©",
      "30- Ù‚Ø±ÙŠØ© Ø§Ù„Ø¹Ø§Ù…Ø±Ø©",
      "31- Ù‚Ø±ÙŠØ© Ù…ØµØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©",
      "32- Ù‚Ø±ÙŠØ© Ø¹Ø±Ø¨ Ø²ÙŠØ¯Ø§Ù†",
      "33- Ù‚Ø±ÙŠØ© Ø§Ù„Ø³ØªØ§ÙŠØªØ©",
      "34- Ù‚Ø±ÙŠØ© ÙƒÙØ± Ø­Ø¬Ø§Ø¬",
      "35- Ù‚Ø±ÙŠØ© Ù…ÙŠØª Ø®Ø¶ÙŠØ±",
      "36- Ù‚Ø±ÙŠØ© Ø§Ù„Ù…ÙˆØ§Ø¬Ø¯",
      "37- Ù‚Ø±ÙŠØ© Ø§Ù„Ø¨ØµØ±Ø§Ø·",
      "38- Ù‚Ø±ÙŠØ© Ù…ÙŠØª Ø´Ø±ÙŠÙ",
      "39- Ù‚Ø±ÙŠØ© Ø§Ù„Ø·ÙˆØ§Ø¨Ø±Ø©",
      "40- Ù‚Ø±ÙŠØ© Ø§Ù„Ø¹Ù…Ø§Ø±Ù†Ø©",
      "41- Ù‚Ø±ÙŠØ© Ø£ÙˆÙ„Ø§Ø¯ Ø¨Ø§Ù†Ø§",
      "42- Ù‚Ø±ÙŠØ© Ø£ÙˆÙ„Ø§Ø¯ Ø­Ø§Ù†Ø§",
      "43- Ø¨Ø­Ø± Ø­Ø§Ø¯ÙˆØ«",
      "44- Ù‚Ø±ÙŠØ© Ø§Ù„Ù‚Ø²Ø§Ù‚Ø²Ø©",
      "45- Ù‚Ø±ÙŠØ© Ø§Ù„Ø­ÙˆØªØ©",
      "46- Ù‚Ø±ÙŠØ© Ø£ÙˆÙ„Ø§Ø¯ Ù†ÙˆØ±",
      "47- Ù‚Ø±ÙŠØ© Ø§Ù„Ø®Ù„Ø§ÙŠÙØ©",
      "48- Ù‚Ø±ÙŠØ© Ø§Ù„Ù‚Ø·Ø´Ø©",
      "49- Ù‚Ø±ÙŠØ© Ø§Ù„Ø¬Ù…Ø§Ù…Ù„Ø©",
      "50- Ù‚Ø±ÙŠØ© Ø§Ù„Ø¹Ø²ÙŠØ²Ø©",
      "51- Ù‚Ø±ÙŠØ© Ø§Ù„Ø£Ø­Ù…Ø¯ÙŠØ©",
      "52- Ù‚Ø±ÙŠØ© Ø§Ù„Ø¹Ø±Ø¨Ø§Ù†",
      "53- Ù‚Ø±ÙŠØ© Ø£ÙˆÙ„Ø§Ø¯ Ø¹Ù„Ù…",
      "54- Ù‚Ø±ÙŠØ© Ø£ÙˆÙ„Ø§Ø¯ Ù†Ø§ØµØ±",
      "55- Ù‚Ø±ÙŠØ© Ø¨Ù†ÙŠ Ù‡Ù„Ø§Ù„",
      "56- Ù‚Ø±ÙŠØ© Ø§Ù„Ø´Ø¨ÙˆÙ„",
      "57- Ù‚Ø±ÙŠØ© Ø§Ù„Ø±ÙˆØ¯Ø©",
      "58- Ù‚Ø±ÙŠØ© Ø§Ù„Ù†Ø³Ø§ÙŠÙ…Ø©",
      "59- Ù‚Ø±ÙŠØ© Ø§Ù„Ø¹ØµØ§ÙØ±Ø©",
      "60- Ù‚Ø±ÙŠØ© Ø§Ù„Ø¶Ù‡ÙŠØ±",
      "61- Ø§Ù„Ù…Ø·Ø±ÙŠØ© Ù†Ù‚Ø·Ø© Ø±Ù‚Ù… 1",
      "62- Ø§Ù„Ù…Ø·Ø±ÙŠØ© Ù†Ù‚Ø·Ø© Ø±Ù‚Ù… 2",
      "63- Ø§Ù„Ù…Ø·Ø±ÙŠØ© Ù†Ù‚Ø·Ø© Ø±Ù‚Ù… 3",
      "64- Ø§Ù„Ù…Ø·Ø±ÙŠØ© Ù†Ù‚Ø·Ø© Ø±Ù‚Ù… 4",
      "65- Ø§Ù„Ù…Ø·Ø±ÙŠØ© Ù†Ù‚Ø·Ø© Ø±Ù‚Ù… 5",
      "66- Ø§Ù„Ù…Ø·Ø±ÙŠØ© Ù†Ù‚Ø·Ø© Ø±Ù‚Ù… 6",
      "67- Ø§Ù„Ù…Ø·Ø±ÙŠØ© Ù†Ù‚Ø·Ø© Ø±Ù‚Ù… 7",
      "68- Ø§Ù„Ù…Ø·Ø±ÙŠØ© Ù†Ù‚Ø·Ø© Ø±Ù‚Ù… 8",
      "69- Ø§Ù„Ù…Ø·Ø±ÙŠØ© Ù†Ù‚Ø·Ø© Ø±Ù‚Ù… 9"
    ];

    // Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø­Ø¯Ø«Ø© (900901 Ø¥Ù„Ù‰ 900969)
    const loginCodes = {};
    
    // Ø¥Ù†Ø´Ø§Ø¡ Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ø¯Ø®ÙˆÙ„ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ù…Ø§ÙƒÙ†
    for (let i = 1; i <= 69; i++) {
      const code = `9009${i.toString().padStart(2, '0')}`;
      loginCodes[code] = {
        place: places[i-1],
        placeIdx: i
      };
    }
    
    // Ø¥Ø¶Ø§ÙØ© ÙƒÙˆØ¯ Ø§Ù„ØªØ­Ù‚Ù‚ Ø§Ù„Ø®Ø§Øµ
    loginCodes["111111"] = { place: "Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©", placeIdx: 0 };
    
    // ØªØµØ¯ÙŠØ± Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¹Ø§Ù…
    window.PLACES = places;
    window.LOGIN_CODES = loginCodes;

    // Ø¯Ø§Ù„Ø© Ù„Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„ÙƒÙˆØ¯ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø­ÙÙˆØ¸
    function loadRememberedLogin() {
      const rememberedCode = localStorage.getItem('rememberedLoginCode');
      const rememberChecked = localStorage.getItem('rememberLoginChecked') === 'true';
      
      if (rememberedCode && rememberChecked) {
        document.getElementById('loginCode').value = rememberedCode;
        document.getElementById('rememberLogin').checked = true;
      }
    }

    // Ø§Ù„Ø¨Ø­Ø« Ø§Ù„ØµÙˆØªÙŠ
    let recognition = null;
    let isListening = false;
    
    function initializeVoiceSearch() {
      if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        recognition = new SpeechRecognition();
        
        recognition.lang = 'ar-SA';
        recognition.continuous = false;
        recognition.interimResults = false;
        
        recognition.onstart = function() {
          isListening = true;
          document.getElementById('voiceSearchBtn').classList.add('listening');
          document.getElementById('voiceStatus').textContent = "ğŸ¤ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø¹...";
          document.getElementById('voiceStatus').style.display = 'block';
        };
        
        recognition.onresult = function(event) {
          const transcript = event.results[0][0].transcript.replace(/\D/g, '');
          
          if (transcript.length >= 6) {
            const code = transcript.slice(0, 6);
            document.getElementById('loginCode').value = code;
            document.getElementById('voiceStatus').textContent = `âœ… ØªÙ… Ø¥Ø¯Ø®Ø§Ù„: ${code}`;
            
            // Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¨Ø¹Ø¯ 1 Ø«Ø§Ù†ÙŠØ©
            setTimeout(() => {
              document.getElementById('voiceStatus').style.display = 'none';
              login();
            }, 1000);
          } else {
            document.getElementById('voiceStatus').textContent = "âš  Ø§Ù„Ø±Ø¬Ø§Ø¡ Ù†Ø·Ù‚ 6 Ø£Ø±Ù‚Ø§Ù…";
          }
        };
        
        recognition.onerror = function(event) {
          console.error('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ¹Ø±Ù Ø§Ù„ØµÙˆØªÙŠ:', event.error);
          document.getElementById('voiceStatus').textContent = "âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ØŒ Ø­Ø§ÙˆÙ„ Ù…Ø¬Ø¯Ø¯Ø§Ù‹";
          setTimeout(() => {
            document.getElementById('voiceStatus').style.display = 'none';
          }, 3000);
        };
        
        recognition.onend = function() {
          isListening = false;
          document.getElementById('voiceSearchBtn').classList.remove('listening');
        };
      } else {
        console.log('Ø§Ù„Ù…ØªØµÙØ­ Ù„Ø§ ÙŠØ¯Ø¹Ù… Ø§Ù„ØªØ¹Ø±Ù Ø§Ù„ØµÙˆØªÙŠ');
        document.getElementById('voiceSearchBtn').style.display = 'none';
      }
    }
    
    window.toggleVoiceSearch = function() {
      if (!recognition) {
        alert('Ø§Ù„ØªØ¹Ø±Ù Ø§Ù„ØµÙˆØªÙŠ ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…. ÙŠØ±Ø¬Ù‰ Ø§Ø³ØªØ®Ø¯Ø§Ù… Chrome Ø£Ùˆ Edge.');
        return;
      }
      
      if (isListening) {
        recognition.stop();
      } else {
        recognition.start();
      }
    };
    
    // Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
    document.addEventListener('DOMContentLoaded', function() {
      loadRememberedLogin();
      initializeVoiceSearch();
      
      // Ø¥Ø¶Ø§ÙØ© Ø§Ø®ØªØµØ§Ø± Ctrl+Enter Ù„Ù„Ø¯Ø®ÙˆÙ„
      document.addEventListener('keydown', function(e) {
        if (e.ctrlKey && e.key === 'Enter') {
          if (!document.getElementById('auth-card').classList.contains('hidden')) {
            login();
          }
        }
      });
    });
    
    // Ø¯Ø§Ù„Ø© Ù„Ø¥Ø¸Ù‡Ø§Ø± Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…
    window.showAbout = function() {
      alert(`ğŸ’¡ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…:\n\nâ€¢ Ø§Ù„Ù†Ø¸Ø§Ù…: ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ù†Ø§Ø¯ÙŠØ¨\nâ€¢ Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ù…Ø§ÙƒÙ†: ${places.length}\nâ€¢ Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«: ${new Date().toLocaleDateString('ar-EG')}\n\nğŸ‘¨â€ğŸ’» Ø§Ù„Ù…Ø¨Ø±Ù…Ø¬: Ø§Ù„Ù…Ù‡Ù†Ø¯Ø³ Ù…Ø­Ù…Ø¯ Ø­Ù…Ø§Ø¯`);
    };
  </script>

  <script type="module">
    import {
      initializeApp
    } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
    import {
      getDatabase,
      ref,
      set,
      get,
      child,
      push,
      remove,
      onValue,
      update
    } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js";
    
    const firebaseConfig = {
      apiKey: "AIzaSyAxnIxtFeAOjYjCIrU5cwYVteuQ18K8Kjc",
      authDomain: "idmanazla.firebaseapp.com",
      databaseURL: "https://idmanazla-default-rtdb.europe-west1.firebasedatabase.app",
      projectId: "idmanazla",
      storageBucket: "idmanazla.firebasestorage.app",
      messagingSenderId: "408446131276",
      appId: "1:408446131276:web:976ae54181b5398de5a8e9"
    };
    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    function getDeviceId() {
      let id = localStorage.getItem("app_device_id");
      if (!id) {
        id = "dev_" + Math.random().toString(36).substring(2, 10) + Date.now();
        localStorage.setItem("app_device_id", id);
      }
      return id;
    }
    const currentDeviceId = getDeviceId();

    let userPlace = null;
    let userPlaceIdx = null;
    let userID = null;
    let userRepName = null;
    let messagesListener = null;
    let lastMessageCount = 0;
    let alarmInterval = null;
    let isFirstMessagesLoad = true;
    let currentMessagesSnapshot = null;
    let isVerificationMode = false;

    // Ø¯Ø§Ù„Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø­Ø³Ù†Ø©
    window.login = async function () {
      const code = document.getElementById("loginCode").value.trim();
      const msg = document.getElementById("login-msg");
      const rememberMe = document.getElementById("rememberLogin").checked;
      
      msg.textContent = "";
      msg.className = "msg";

      if (code.length < 1) {
        msg.textContent = "ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙˆØ¯ Ø§Ù„Ø¯Ø®ÙˆÙ„";
        msg.classList.add("error");
        return;
      }
      
      // Ø­ÙØ¸ ØªØ°ÙƒØ±Ù†ÙŠ
      if (rememberMe) {
        localStorage.setItem('rememberedLoginCode', code);
        localStorage.setItem('rememberLoginChecked', 'true');
      } else {
        localStorage.removeItem('rememberedLoginCode');
        localStorage.setItem('rememberLoginChecked', 'false');
      }
      
      // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙƒÙˆØ¯ Ø§Ù„ØªØ­Ù‚Ù‚ Ø§Ù„Ø®Ø§Øµ 111111
      if (code === "111111") {
        isVerificationMode = true;
        userID = code;
        userPlace = "Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©";
        
        document.getElementById("auth-card").classList.add("hidden");
        document.getElementById("verification-card").classList.remove("hidden");
        document.getElementById("verification-card").classList.add("fade-in");
        return;
      }
      
      try {
        const snapshot = await get(child(ref(db), "login_codes/" + code));
        
        if (!snapshot.exists()) {
          // Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ Ù…Ù† Ø§Ù„ÙƒØ§Ø¦Ù† Ø§Ù„Ù…Ø­Ø¯Ø¯ Ù…Ø³Ø¨Ù‚Ø§Ù‹
          if (window.LOGIN_CODES[code]) {
            const data = window.LOGIN_CODES[code];
            userID = code;
            userPlace = data.place;
            userPlaceIdx = data.placeIdx || 0;
            isVerificationMode = false;

            // Ø­ÙØ¸ Ø§Ù„ÙƒÙˆØ¯ ÙÙŠ Firebase Ù„Ù„Ù…Ø±Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰
            await set(ref(db, `login_codes/${code}`), {
              place: data.place,
              placeIdx: data.placeIdx || 0
            });
          } else {
            msg.textContent = "Ø§Ù„ÙƒÙˆØ¯ ØºÙŠØ± ØµØ­ÙŠØ­";
            msg.classList.add("error");
            return;
          }
        } else {
          const data = snapshot.val();
          userID = code;
          userPlace = data.place;
          userPlaceIdx = data.placeIdx || 0;
          isVerificationMode = false;
        }

        await enforceSessionLimit(code);
        await set(ref(db, `active_sessions/${code}/${currentDeviceId}`), {
          loginTime: Date.now(),
          expiresAt: Date.now() + 30 * 60 * 1000,
          deviceInfo: navigator.userAgent.substring(0, 100)
        });
        
        document.getElementById("welcome").textContent = `ğŸ“ ${userPlace}`;
        document.getElementById("auth-card").classList.add("hidden");
        document.getElementById("main-card").classList.remove("hidden");
        document.getElementById("main-card").classList.add("fade-in");
        
        loadEntryCounter();
        startMessagesListener();
        
        // ØªØ±ÙƒÙŠØ² Ø¹Ù„Ù‰ Ø­Ù‚Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨
        setTimeout(() => {
          document.getElementById("repName")?.focus();
        }, 300);
        
      } catch (e) {
        msg.textContent = "Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„: " + e.message;
        msg.classList.add("error");
      }
    };

    // Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø¯ÙˆØ§Ù„ ØªØ¨Ù‚Ù‰ ÙƒÙ…Ø§ Ù‡ÙŠ Ù…Ø¹ Ø¨Ø¹Ø¶ Ø§Ù„ØªØ­Ø³ÙŠÙ†Ø§Øª Ø§Ù„Ø·ÙÙŠÙØ© ÙÙŠ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„
    window.checkCard = async function () {
      const msg = document.getElementById("verify-msg");
      msg.textContent = "";
      msg.className = "msg";
      
      const natid = document.getElementById("verifyNatID").value.trim();
      
      if (!/^\d{14}$/.test(natid)) {
        msg.textContent = "Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù‚ÙˆÙ…ÙŠ ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† 14 Ø±Ù‚Ù…";
        msg.classList.add("error");
        return;
      }
      
      try {
        const userRef = ref(db, "users/" + natid);
        const snapshot = await get(userRef);
        
        if (snapshot.exists()) {
          const data = snapshot.val();
          
          playDuplicateAlarm();
          
          msg.className = "duplicate-box";
          msg.innerHTML = `
            âš ï¸ Ø¨Ø·Ø§Ù‚Ø© Ù…Ø³Ø¬Ù„Ø© Ù…Ø³Ø¨Ù‚Ù‹Ø§<br>
            ğŸ“ Ù…Ø³Ø¬Ù„Ø© ÙÙŠ: <b>${data.place}</b><br>
            ğŸ‘¤ Ø¨ÙˆØ§Ø³Ø·Ø©: <b>${data.repName}</b><br>
            â° Ø§Ù„ÙˆÙ‚Øª: ${new Date(data.time).toLocaleString('ar-EG')}
          `;
          
          setTimeout(() => {
            stopDuplicateAlarm();
          }, 10000);
          
        } else {
          stopDuplicateAlarm();
          
          msg.className = "verify-box";
          msg.innerHTML = `
            âœ… Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© ØµØ­ÙŠØ­Ø© ÙˆÙŠÙ…ÙƒÙ† ØªØ³Ø¬ÙŠÙ„Ù‡Ø§<br>
            <span style="font-size: 14px;">Ù‡Ø°Ù‡ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© ØºÙŠØ± Ù…Ø³Ø¬Ù„Ø© ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù…</span>
          `;
        }
        
        document.getElementById("verifyNatID").value = "";
        document.getElementById("verifyNatID").focus();
        
      } catch (e) {
        msg.textContent = "Ø®Ø·Ø£: " + e.message;
        msg.classList.add("error");
      }
    };

    // Ø¯Ø§Ù„Ø© Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø­Ø³Ù†Ø©
    window.addUser = async function () {
      const msg = document.getElementById("add-msg");
      msg.textContent = "";
      msg.className = "msg";
      
      const name = document.getElementById("repName").value.trim();
      const natid = document.getElementById("natID").value.trim();
      
      if (name.length < 2) {
        msg.textContent = "ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨";
        msg.classList.add("error");
        document.getElementById("repName").focus();
        return;
      }
      
      if (!/^\d{14}$/.test(natid)) {
        msg.textContent = "Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù‚ÙˆÙ…ÙŠ ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† 14 Ø±Ù‚Ù…";
        msg.classList.add("error");
        document.getElementById("natID").focus();
        return;
      }
      
      if (!userPlace) {
        msg.textContent = "Ø®Ø·Ø£ â€” Ù„Ù… ÙŠØªÙ… ØªØ­Ø¯ÙŠØ¯ Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¯Ø®ÙˆÙ„";
        msg.classList.add("error");
        return;
      }
      
      try {
        const userRef = ref(db, "users/" + natid);
        const snapshot = await get(userRef);
        
        if (snapshot.exists()) {
          const data = snapshot.val();
          
          playDuplicateAlarm();
          
          msg.className = "duplicate-box";
          msg.innerHTML = `
            âš ï¸ Ø§ÙƒØªØ´Ø§Ù Ø¹Ù…Ù„ÙŠØ© Ù†ØµØ¨<br>
            ğŸ“ Ù…Ø³Ø¬Ù„ ÙÙŠ: <b>${data.place}</b><br>
            ğŸ‘¤ Ø¨ÙˆØ§Ø³Ø·Ø©: <b>${data.repName}</b><br>
            â° Ø§Ù„ÙˆÙ‚Øª: ${new Date(data.time).toLocaleString('ar-EG')}
          `;
          
          await push(ref(db, "duplicates"), {
            duplicatedID: natid,
            attemptByRep: name,
            attemptPlace: userPlace,
            originalRep: data.repName,
            originalPlace: data.place,
            timestamp: new Date().toISOString(),
            deviceId: currentDeviceId
          });
          
          saveRepName(name);
          
          setTimeout(() => {
            stopDuplicateAlarm();
          }, 10000);
          
          return;
        }
        
        await set(userRef, {
          natid,
          repName: name,
          place: userPlace,
          placeIdx: userPlaceIdx,
          time: new Date().toISOString(),
          username: userID,
          deviceId: currentDeviceId
        });
        
        saveRepName(name);
        msg.textContent = "âœ… ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø¨Ù†Ø¬Ø§Ø­";
        msg.classList.add("success");
        document.getElementById("natID").value = "";
        document.getElementById("natID").focus();
        incrementEntryCounter();
        
        // Ø¥Ø´Ø¹Ø§Ø± Ø¨ØµÙˆØª Ù†Ø¬Ø§Ø­
        const successSound = new Audio('https://actions.google.com/sounds/v1/cartoon/cartoon_boing.ogg');
        successSound.volume = 0.3;
        successSound.play().catch(() => {});
        
      } catch (e) {
        msg.textContent = "Ø®Ø·Ø£: " + e.message;
        msg.classList.add("error");
      }
    };

    // Ø¯Ø§Ù„Ø© ØªØ­Ù…ÙŠÙ„ Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ù…Ù†Ø§Ø¯ÙŠØ¨ Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©
    function loadRepNames() {
      let stored = JSON.parse(localStorage.getItem("saved_rep_names") || "[]");
      const list = document.getElementById("repNamesHistory");
      if (!list) return;
      list.innerHTML = "";
      stored.forEach(n => {
        let o = document.createElement("option");
        o.value = n;
        list.appendChild(o);
      });
    }

    // Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø¯ÙˆØ§Ù„ ØªØ¨Ù‚Ù‰ ÙƒÙ…Ø§ Ù‡ÙŠ Ù…Ø¹ ØªØ­Ø³ÙŠÙ†Ø§Øª Ø·ÙÙŠÙØ©
    // ... (Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ø£Ø®Ø±Ù‰ ØªØ¨Ù‚Ù‰ ÙƒÙ…Ø§ Ù‡ÙŠ Ù…Ø¹ ØªØ­Ø³ÙŠÙ†Ø§Øª Ø¨Ø³ÙŠØ·Ø© ÙÙŠ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„)

  </script>
</body>
</html>
